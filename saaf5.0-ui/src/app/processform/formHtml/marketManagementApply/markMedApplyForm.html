<!-- Created by baijianlong on 2018-10-31 -->
<div ng-controller="markMedApplyFormCtrl" class="gridtable">
    <div class="data-table" id="processForm" data-api-post="saveOaMarketingCostMedia"
         data-api-get="findOaMarketingCostMediaDetailById" data-api-del="" data-api-update="updateOaMarketingCostMedia">
        <div class="col-md-12 pt15">
            <h5 class="fontwB"><span class="fa fa-cog mr15"></span>申请信息</h5>
            <div resp-change="" class="col-xs-6 col-md-4 col-lg-3" style="display: none" data-load-callback="respCallback"></div>
            <div class="row">
                <div search-list
                     data-col="4"
                     data-legend="[
                        {key:'deptName',label:'申请部门',readonly:true,required:true},
                        {key:'personName',label:'申请人',readonly:true,required:true},
                        {key:'positionName',label:'职位',readonly:true,type:'lov',target:'#positionByPersonModel',required:true,css:'readonly-white'},
                        {key:'billNo',label:'申请单号',readonly:true},
                        {key:'requestTime',label:'申请时间',type:'time',disabled:true},
                        {key:'statusStr',label:'状态',readonly:true},
                        ]"
                     ng-model="formParams"
                ></div>
            </div>
            <div class="row">
                <div class="form-group col-xs-6 col-md-4">
                    <div class="input-group input-group-xs">
                        <label class="input-group-addon bn">
                            <span class="w100"><i class="red">*</i>申请主体</span></label>
                        <label class="radio-inline"><input type="radio" ng-model="formParams.costMain" name="costMain" ng-value="'Y'" ng-change="yesOrNo()">人员</label>
                        <label class="radio-inline"><input type="radio" ng-model="formParams.costMain" name="costMain" ng-value="'N'" ng-change="yesOrNo()">经销商</label>
                    </div>
                </div>
                <div class="form-group col-xs-6 col-md-4" ng-if="formParams.costMain == 'Y'">
                    <div class="input-group input-group-xs  positionName_2">
                        <label class="input-group-addon bn ng-scope">
                            <span class="w100 ng-binding"><i class="red ng-scope">* </i>费用人员</span>
                        </label>
                        <input type="text"
                               class="form-control radius3 ng-pristine ng-untouched ng-valid ng-scope ng-not-empty ng-valid-required ng-valid-maxlength readonly-white"
                               ng-required="true"
                               maxlength=""
                               name="showPerson"
                               data-required-msg=""
                               data-error-msg=""
                               id="showPerson"
                               placeholder=""
                               ng-model="formParams.costUserName"
                               required="required"
                               readonly="true">
                        <span class="input-group-btn ng-scope" data-toggle="modal" data-target="#purchaseRequisitionsDepartment">
                            <a class="btn btn-default"><i class="fa fa-search"></i></a>
                        </span>
                    </div>
                </div>
                <div class="form-group col-xs-6 col-md-4" ng-if="formParams.costMain == 'N'">
                    <div class="input-group input-group-xs  positionName_2">
                        <label class="input-group-addon bn ng-scope">
                            <span class="w100 ng-binding"><i class="red ng-scope">* </i>费用经销商</span>
                        </label>
                        <input type="text"
                               class="form-control radius3 ng-pristine ng-untouched ng-valid ng-scope ng-not-empty ng-valid-required ng-valid-maxlength readonly-white"
                               ng-required="true"
                               maxlength=""
                               name="showPerson"
                               data-required-msg=""
                               data-error-msg=""
                               id="showPerson"
                               placeholder=""
                               ng-model="formParams.custAccountName"
                               required="required"
                               readonly="true">
                        <span class="input-group-btn ng-scope" data-toggle="modal" data-target="#dealerInfo_h">
                            <a class="btn btn-default"><i class="fa fa-search"></i></a>
                        </span>
                    </div>
                </div>
                <!--{key:'expensePeriod',label:'费用期间',required:true,type:'lov',readonly:true,target:'#expensePeriodLov',css:'readonly-white'},-->
                <div search-list
                     data-col="4"
                     data-legend="[
                        {key:'channelType',label:'渠道',required:true,disabled:true},
                        {key:'departmentName',label:'费用部门',required:true,disabled:true},
                        {key:'expenseAccountName',label:'费用科目',required:true,type:'lov',readonly:true,target:'#expensesCourse',css:'readonly-white'},
                    ]"
                     ng-model="formParams"
                ></div>
                <div class="form-group col-xs-6 col-md-4 ng-scope">
                    <div class="input-group input-group-xs  expensePeriod_3">
                        <label class="input-group-addon bn ng-scope">
                            <span class="w100 ng-binding"><i class="red ng-scope">* </i>费用期间</span>
                        </label>
                        <select class="form-control input-xs" ng-model="formParams.expensePeriod">
                            <option value="">请选择</option>
                            <option ng-value="expensePeriod.expensePeriod" ng-repeat="expensePeriod in expensePeriodList">{{expensePeriod.expensePeriod}}</option>
                        </select>
                    </div>
                </div>
                <div search-list
                     data-col="4"
                     data-legend="[
                        {key:'expenseType',label:'费用类型',required:true,type:'lookCode',lookCode:'EXPENSE_TYPE'},
                        {key:'startDate',label:'开始时间',required:true,type:'time',endDate:'endDate'},
                        {key:'endDate',label:'结束时间',required:true,type:'time',startDate:'startDate'},
                        {key:'encumbranceAmount',label:'提交金额',required:true},

                    ]"
                     ng-model="formParams"
                ></div>
                <div search-list data-col="4" ng-if="action!='new'" data-legend="[
                        {key:'expenseAmount',label:'报销金额',disabled:true},
                        {key:'reverseAmount',label:'冲回金额',disabled:true},
                    ]"
                     ng-model="formParams"></div>
            </div>
            <div class="row">
                <div class="form-group col-xs-6 col-md-12">
                    <div class="input-group input-group-xs">
                        <label class="input-group-addon bn"><span
                                class="w100"><i class="red">*</i>申请原因</span></label>
                        <textarea class="form-control" rows="1" auto-textarea="" ng-model="formParams.eventDesc" maxlength="500" placeholder="字数限制500" required name="eventDesc" style="height: auto"></textarea>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-xs-6 col-md-12">
                    <div class="input-group input-group-xs">
                        <label class="input-group-addon bn"><span
                                class="w100"><i class="red">*</i>会签意见</span></label>
                        <textarea class="form-control" rows="1" auto-textarea="" ng-model="formParams.signOpinion" maxlength="500" placeholder="字数限制500" required name="signOpinion" style="height: auto"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-12 pt5">
            <h5 class="fontwB"><span class="fa fa-cog mr15"></span>营销媒体信息</h5>
             <div class="row">
                <div search-list
                     data-col="4"
                     data-legend="[
                        {key:'mediaType',label:'媒体形式',required:true,type:'lookCode',lookCode:'OA_MEDIA_FORM'},
                    ]"
                     ng-model="formParams.itemMedia[0]"
                ></div>
                 <div search-list
                      ng-if="formParams.itemMedia[0].mediaType==19"
                      data-col="4"
                      data-legend="[
                        {key:'otherTypeName',label:'其他媒体形式',required:true},
                    ]"
                      ng-model="formParams.itemMedia[0]"
                 ></div>
                 <div search-list
                      data-col="4"
                      data-legend="[
                        {key:'mediaNum',label:'媒体数量',required:true,validFormat:'number=-1'},
                        {key:'releasePeriod',label:'发布周期',required:true,validFormat:'number=-1'},
                        {key:'prePinNum',label:'投放前动销数',required:true,validFormat:'number=-1'},
                        {key:'drivenPinNum',label:'预设动销厅数',required:true,validFormat:'number=-1'},
                    ]"
                      ng-model="formParams.itemMedia[0]"
                 ></div>
                 <div class="form-group col-xs-12 col-md-12">
                     <div class="input-group input-group-xs">
                         <label class="input-group-addon bn">
                             <span class="w100"><i class="red">*</i>投放目的</span></label>
                         <div class="checkbox " style="margin: 0">
                             <label ng-repeat="item in buData"  class="checkbox-inline w160"
                                    style="margin-left: 0; margin-right: 15px;width: 100px" ng-click="checkOU($event,item)">
                                 <input type="checkbox" name="ouIds"  ng-required="true" ng-disabled="isEdit"
                                        ng-checked="item.checked" >{{ item.meaning }}
                             </label>
                         </div>

                         <!-- <div lookup-code="OA_OU" ng-model="addParams.admGiftType"
                              required
                              name="transactionActionName" ></div> -->

                     </div>
                 </div>
                 <div search-list
                      ng-if="formParams.itemMedia[0].deliveryPurpose&&formParams.itemMedia[0].deliveryPurpose.indexOf('5')!=-1"
                      data-col="4"
                      data-legend="[
                        {key:'otherTypeName',label:'其他投放目的',required:true},
                    ]"
                      ng-model="formParams.itemMedia[0]"
                 ></div>
            </div>
        </div>
        <div class="col-md-12 hook-normal">
            <div saaf-file="" data-label="<h5 class='fontwB'><span class='fa fa-cog mr15'></span>附件列表</h5>"
                 data-file-data="fileData.file"
                 data-file-filter='{{fileType}}'
                 data-view-only="fileViewOnly"
            ></div>
        </div>
    </div>
    <!-- 申请人 -->
    <div lov-list="department" role="dialog" data-title="请选择人员" id="purchaseRequisitionsDepartment" ng-model="code"  class="  "
         data-url="personList"
         data-params="{userAuth:'maintain',allLowerPerson:'Y'}"
         data-return-model="{key:'formParams',attr:['costUserId=personId','costUserName=personName','departmentCode=departmentId','departmentId=departmentId','channelCode=channelCode','channelType=channelName','departmentId=departmentId','departmentName=departmentName']}"
         data-callback="getCostUser"
         data-auto-request = 'false'
         data-dynamic-params="departmentParams"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="radio"
         data-keys="{'key':'accessId','value':'personName',name:'人员名称',hide:'true'}"
         data-other-column="[{'name':'工号','key':'employeeNumber'},{'name':'人员名称','key':'personName'},{'name':'部门','key':'departmentName'},{'name':'职位','key':'positionName'}]"
         data-show-index="false"
         data-search-key="[{'key':'personName','placeholder':'请输入姓名'}]"
    >
    </div>
    <!-- 经销商 -->
    <div lov-list="personCusBankPaginatioLov"
         id="deCode1"
         ng-model="code1"
         data-return-model="{key:'formParams',attr:['custAccountId=custAccountId','custAccountName=custAccountName']}"
         data-url="findCustomerPagination"
         data-dynamic-params="customerParams"
         data-callback="getCustAccount"
         data-title="请选择经销商"
         data-checked-type="radio"
         data-search-key="[{'key':'customerName','placeholder':'经销商名称'},{'key':'customerNumber','placeholder':'经销商编码'}]"
         data-keys="{'key':'customerNumber','value':'customerName',hide:true}"
         data-other-column="[{'name':'经销商编码','key':'customerNumber'},{'name':'经销商名称',key:'customerName'}]"
    ></div>
    <!-- 经销商2 -->
    <div lov-list="personCusBankPaginatioLov"
         id="deCode2"
         ng-model="code3"
         data-url="findCustomerPagination"
         data-callback="getCustAccount2"
         data-title="请选择经销商"
         data-checked-type="radio"
         data-search-key="[{'key':'customerName','placeholder':'经销商名称'},{'key':'customerNumber','placeholder':'经销商编码'}]"
         data-keys="{'key':'customerNumber','value':'customerName',hide:true}"
         data-other-column="[{'name':'经销商编码','key':'customerNumber'},{'name':'经销商名称',key:'customerName'}]"
    ></div>
    <!-- 费用科目 -->
    <div lov-list="expensesCourse" role="dialog" data-title="请选择费用科目" id="expensesCourse" ng-model="code2"  class="  "
         data-url="findExpenseAccountOutList"
         data-dynamic-params="getRespParams"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-callback="getExpenseAccount"
         data-checked-type="radio"
         data-keys="{'key':'expenseAccountId','value':'expenseAccountName','hide':'true'}"
         data-other-column="[{'name':'费用科目编码','key':'expenseAccountId'},{'name':'费用科目名称','key':'expenseAccountName'}]"
         data-show-index="false"
         data-search-key="[{'key':'expenseAccountId','placeholder':'请输入费用科目编码'},{'key':'expenseAccountName','placeholder':'请输入费用科目名称'}]"
    ></div>
    <!-- 人员下属门店名称 -->
    <div lov-list="erpStoreList" role="dialog" data-title="请选择门店" id="erpStoreList1" ng-model="code2"  class="  "
         data-url="findStorePaginationByPerson"
         data-dynamic-params="storeParams"
         data-callback="getStoreByPerson"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="radio"
         data-keys="{'key':'storeCode','value':'storeName',name:'门店名称'}"
         data-other-column="[{'name':'门店编码','key':'storeCode'}]"
         data-show-index="false"
         data-search-key="[{'key':'storeCode','placeholder':'请输入门店编码'},{'key':'storeName','placeholder':'请输入门店名称'}]"
    >
    </div>
    <!-- 经销商下属门店名称 -->
    <div lov-list="erpStoreList" role="dialog" data-title="请选择门店" id="erpStoreList2" ng-model="code2"  class="  "
         data-url="findStorePagination"
         data-dynamic-params="storeParams"
         data-callback="getStoreByCustAccount"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="radio"
         data-keys="{'key':'storeCode','value':'storeName',name:'门店名称'}"
         data-other-column="[{'name':'门店编码','key':'storeCode'}]"
         data-show-index="false"
         data-search-key="[{'key':'storeCode','placeholder':'请输入门店编码'},{'key':'storeName','placeholder':'请输入门店名称'}]"
    >
    </div>
    <!-- 费用期间 -->
    <div lov-list="expensePeriodLov"
         id="expensePeriodLov"
         ng-model="code5"
         data-url="expensePeriodList"
         data-dynamic-params="expensePeriodLovParams"
         data-title="请选择费用期间"
         data-checked-type="radio"
         data-callback="getExpensePeriod"
         data-search-key="[{'key':'expensePeriod','placeholder':'费用期间'}]"
         data-keys="{'key':'RN','value':'expensePeriod','name':'费用期间'}"
    ></div>



    <!-- 城市 -->
    <div class="modal fade" id="citysModal1" data-des="请选择城市" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog ">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        请选择城市
                    </h4>
                </div>
                <form class="ngValid" >
                    <div class="modal-body oh">
                        <div city-area="businessCity" ng-model="citys" class="col-xs-12" data-select-level="4"></div>
                    </div>

                    <div class="modal-footer ">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button type="button" ng-click="citySave1()" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>



    <!--部门控件-->
    <div ems-dept-select data-sel-params="{respId:urlParams.respId,orgId:orgId,departmentId:formParams.departmentId,sysFlag:flag}"
         id="deptInfo" ng-model="deptModel" class="hook-normal"
         data-keys="{key:'departmentId',value:'departmentName'}" dept-type="row" data-search-auto="true"
         callaction="selDeptFun()" emptyaction="empDeptFun()"></div>

    <!--人员-->
    <div e-user-line-select role="dialog" data-title="请选择行人员" id="userInfo" ng-model="userModel" data-search-auto="true" class="hook-normal"
         ng-params="{responsibilityId:respId,orgId:orgId,userType:userType,departmentId:formParams.departmentId,
         hpersonId:formParams.costUserId,expenseType:formParams.expenseType,sysFlag:flag}"
         return-fun="selUserFun">
    </div>

    <!--经销商-->
    <div ems-dealer-select data-sel-params="{responsibilityId:respId,orgId:orgId,departmentId:formParams.departmentId,
    hcustAccountId:formParams.custAccountId,hpersonId:formParams.costUserId,channelType:formParams.channelType,sysFlag:flag}"
         id="dealerInfo" ng-model="dealerItem" class="hook-normal"
         data-keys="{key:'customerId',value:'customerName'}" data-dir-type="row"
         data-search-auto="true"
         callaction="dealerSelectFun()" emptyaction="dealerEmptyFun()"></div>

    <!--费用申请-->
   <!-- <div e-apply-select="findApplyCost" role="dialog" data-title="请选择申请费用" id="applyNumber" ng-model="applyItem" class="hook-normal"
         data-search-auto="true"
         ng-params="{responsibilityId:urlParams.respId,orgId:urlParams.orgId,userType:urlParams.userType,channelType:urlParams.channelType}"  return-fun="feeApplySelectFun">
    </div>-->
    <div lov-list="applyNumber" role="dialog" data-title="请选择编号" id="applyNumber" ng-model="code3"  class=""
         data-css="modal-lg"
         data-url="bx_findOaMarketingCostSalesPagination"
         data-dynamic-params="orderParams"
         data-callback="getCostUser"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="radio"
         data-keys="{'key':'requestNum','value':'personName',name:'人员名称',hide:'true'}"
         data-other-column="[{'name':'申请编号','key':'requestNum'},{'name':'申请人','key':'personName'},{'name':'申请部门','key':'departmentName'},{'name':'费用人员','key':'costUserName'},{'name':'经销商','key':'custAccountName'},{'name':'费用科目','key':'expenseAccountName'},{'name':'费用期间','key':'expensePeriod'},{'name':'提交金额','key':'encumbranceAmount'}]"
         data-show-index="false"
         data-search-key="[{'key':'personName','placeholder':'请输入申请人姓名'}]"
    ></div>

    <!--费用项目-->
    <div ems-expense-select data-sel-params="{expenseAccountId:formParams.expenseAccount}"
         id="expenseInfo" ng-model="expenseItem" class="hook-normal"
         data-keys="{key:'expenseItemId',value:'expenseItemDesc'}"
         data-search-auto="true"
         callaction="expenseSelectFun()" emptyaction="expenseEmptyFun()"></div>

    <!--银行账号-->
    <div ems-bank-info-select data-sel-params="bankParams"
         id="bankInfo" ng-model="bankItem" data-search-auto="true"
         data-keys="{key:'bankAccount',value:'bankName'}" class="hook-normal"
         callaction="bankSelectFun()" emptyaction="bankEmptyFun()"></div>





    <!--头 人员-->
    <div e-user-select role="dialog" data-title="请选择头人员" id="userInfo_h" ng-model="userModel_h" class="hook-normal"
         ng-params="{responsibilityId:urlParams.respId,orgId:urlParams.orgId,userType:urlParams.userType,userAuth:'maintain'}" return-fun="selUserHeaderFun">
    </div>

    <!--头 经销商-->
    <div ems-dealer-select data-sel-params="{responsibilityId:respId,orgId:orgId,userAuth:'maintain'}"
         id="dealerInfo_h" ng-model="dealerModel_h" class="hook-normal"
         data-keys="{key:'customerId',value:'customerName'}" data-dir-type="header"
         data-search-auto="false"
         callaction="dealerHeaderSelectFun()" emptyaction="dealerHeaderEmptyFun()"></div>

    <!--头 费用科目-->
    <div ems-exp-subject-select data-sel-params="{responsibilityId:respId,orgId:orgId,userType:userType,
        channelType:channelType,isReimburseAuth:'M',needEncumbrance:'N',isLeafFlag:'Y',userAuth:'maintain'}" id="expInfo" ng-model="expModel"
         data-keys="{key:'expenseAccountId',value:'expenseAccountName'}" class="hook-normal" data-search-auto="true"
         callaction="expSelectFun()" emptyaction="expEmptyFun()"></div>
</div>

<style type="text/css">
    .fileBtn{    opacity: 0;
        position: absolute;
        top: -2px;
        left: -8px;
        height: 34px;
        width: 80px;
        padding: 5px 0;
        overflow: hidden;}
    .fileDiv{
        cursor: pointer; position: relative;border-radius: 3px;
        overflow: hidden;display: inline-table;
    }

    .fileBtn_disable,.fileBtn_disable:hover{
        background-color: #85b4dd;
        border-color: #7cacd4;
    }
    .fileBtn_disableTwo,.fileBtn_disableTwo:hover{
        background-color: #85b4dd;
        border-color: #7cacd4;
    }
    .fileBtn_disableTwo input{
        display: none;
    }
    .fileBtn_disable input{
        display: none;
    }

    .fileBtn_disableThree,.fileBtn_disableThree:hover{
        background-color: #85b4dd;
        border-color: #7cacd4;
    }
    .fileBtn_disableFour,.fileBtn_disableFour:hover{
        background-color: #85b4dd;
        border-color: #7cacd4;
    }
    .fileBtn_disableFives,.fileBtn_disableFives:hover{
        background-color: #85b4dd;
        border-color: #7cacd4;
    }
    .fileBtn_disableThree input{
        display: none;
    }
    .fileBtn_disableFour input{
        display: none;
    }
    .fileBtn_disableFives input{
        display: none;
    }
    .ifNoNeed{
        background-color: white!important;
    }
</style>