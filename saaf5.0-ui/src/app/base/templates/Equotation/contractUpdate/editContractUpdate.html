<div ng-controller="editContractUpdateCtrl" class="bigdata">
    <div>
        <div class="bg-gray-white bt">
            <div class="bg-gray-white p5">
                <div class="pull-right ml10">
                    <div class="btn-group btn-group-xs">
                        <!--data-validate-form="addForm"-->
                        <!--permission-btn="btnSave"-->
                        <button class="btn btn-default" type="button" ng-click="btnSave('save')"
                                ng-if="saveFlag">
                            <i class="fa fa-save" aria-hidden="true"></i>{{$l('保存')}}
                        </button>
                        <button class="btn btn-default" type="button" ng-click="btnSave('submit')"
                                ng-if="submitFlag">
                            <i class="fa fa-bullseye" aria-hidden="true"></i>{{$l('提交')}}
                        </button>
                    </div>
                </div>
                <div class="btn-group btn-group-xs ">
                    <button type="button" class="btn btn-primary" ng-click="fullWindow($event)"><i
                            class="fa fa-square-o"></i>{{$l('数据全屏')}}
                    </button>
                </div>
            </div>
        </div>
        <div main-scroll-style data-des="{{$l('此节点必需－用户计算滚动区域高度')}}">
            <div class="nicescroll-height  bg-white " ng-nicescroll
                 nice-option="{cursorcolor: '#998279',cursorwidth:10}"
                 data-des="{{$l('此节点必需-滚动内容及指令')}}">

                <!--------------------- 输入表单  --->

                <form name="addForm" class="table-hover report-data"
                      data-des="{{$l('此节点必需－用于识别输入表单的指令')}}">

                    <form>
                        <header class="col-xs-12 mb10">
                            <i class="fa fa-cog" aria-hidden="true"></i>
                            <span>{{$l('Commercial contract审核导入更新')}}</span>
                        </header>
                        <div class="form-group col-xs-4 col-md-4">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">{{$l('单据编号')}}:</span></label>
                                <input type="text" class="form-control radius3" name="updateCode"
                                       ng-model="headData.updateCode" readonly>
                            </div>
                        </div>
                        <div class="form-group col-xs-4 col-md-4">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">{{$l('单据状态')}}:</span></label>
                                <input type="text" class="form-control radius3" name="docStatusMeaning"
                                       ng-model="headData.docStatusMeaning" readonly>
                            </div>
                        </div>
                        <div class="form-group col-xs-4 col-md-4">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">{{$l('创建时间')}}:</span></label>
                                <input type="text" class="form-control radius3" name="creationDate"
                                       ng-model="headData.creationDate" readonly>
                            </div>
                        </div>
                        <div class="form-group col-xs-4 col-md-4">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">{{$l('创建人')}}:</span></label>
                                <input type="text" class="form-control radius3" name="userFullName"
                                       ng-model="headData.userFullName" readonly>
                            </div>
                        </div>
                        <div class="form-group col-xs-4 col-md-4">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">{{$l('部门')}}:</span></label>
                                <input type="text" class="form-control radius3" name="deptName" readonly
                                       ng-model="headData.deptName" required>
                            </div>
                        </div>
                        <div class="form-group col-xs-4 col-md-4">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span
                                        class="w100">{{$l('附件')}}:</span></label>
                                <input type="file" name="file1" ng-if="headData.fileId==null" id="file1"
                                       onchange="angular.element(this).scope().uploadFileForHead()"
                                       emms-file-upload="myFile1" ng-disabled="!editFlag">
                                <span class="input-group-addon bn" ng-if="headData.fileId!=null"
                                      style="width: 230px;text-align: left;height:23px;display:inline-block;">
                                    <a class="ellipsis" style="color:blue;display: block;width: 220px;"
                                       href="{{headData.filePath}}"
                                       target="_blank">{{headData.fileName}}
                                    </a>
                                </span>
                                <span type="button" ng-click="changeFileForHead()" class="btn btn-primary btn-xs"
                                      ng-if="headData.fileId !=null && editFlag== true"
                                >
                                        <i class="fa fa-plus">{{$l('重新上传')}}</i>
                                    </span>
                            </div>
                        </div>

                        <div class="form-group col-xs-8 col-md-8">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">{{$l('备注说明')}}:</span></label>
                                <input type="text" class="form-control radius3" name="remark"
                                       ng-model="headData.remark" ng-readonly="!editFlag">
                            </div>
                        </div>
                        <div class="row"></div>

                        <div class="form-group col-xs-12 col-md-12">
                            <label style="margin-left: 10px"></label>
                            <!--permission-buttons="btnNew"-->
                            <div class="btn-group btn-group-xs ml5 pull-right" ng-if="editFlag">
                                <button type="button" class="btn btn-default btn-xs" ng-click="btnNew()"><i
                                        class="fa fa-plus">{{$l('新增')}}</i></button>
                            </div>
                            <div class="btn-group btn-group-xs ml5 pull-right" permission-btn-group="btnImport"
                                 ng-style="myStyle"
                                 id="isSq" ng-if="editFlag">
                                <button class="btn btn-default  a-black "
                                        onclick="window.location.href='app/base/templates/Equotation/exampleFlie/commercialContract.xlsx'">
                                    <i class="fa fa-file-excel-o"></i>{{$l('导入模板下载')}}
                                </button>
                                <!--序号	供应商档案号	供应商名称	品类	分数	结果	有效期从	有效期至-->
                                <!--supplierNumber:{headName:'序号'},-->
                                <button type="button" class="btn btn-default" saaf-xls-import-component
                                        data-list-options="{supplierNumber:{headName:'供应商档案号*'},
                                                            supplierName:{headName:'供应商名称'},
                                                            score:{headName:'分数*'},
                                                            beginValidDate:{headName:'有效期从*'},
                                                            endValidDate:{headName:'有效期至*'}}"
                                        data-url="saveImportForContractUpdate"
                                        data-info="{updateHeadId:'{{editParams.updateHeadId}}'}"
                                        data-after-action="returnFlash()"
                                        data-message="供应商档案号/分数/有效期从/有效期至均不能为空，有效期从/有效期至为时间格式为:yyyy-mm-dd">
                                    <i class="fa fa-upload"></i>{{$l('导入')}}
                                </button>
                            </div>


                            <div class="data-table">
                                <table saaf-table="dataTable"
                                       data-url="findContractUpdateLinePagination"
                                       data-params="editParams"
                                       data-checked-type="radio"
                                       data-auto-get-data="false"
                                       data-page-rows="10"
                                       class="table table-bordered table-hover table-condensed">
                                    <thead class="bg-gray-white" style="background-color: #E2EFEF">
                                    <tr class="text-center">
                                        <th>{{$l('序号')}}</th>
                                        <th>{{$l('属性')}}</th>
                                        <th><i class="red">*</i>{{$l('供应商档案号')}}</th>
                                        <th>{{$l('供应商名称')}}</th>
                                        <th><i class="red">*</i>{{$l('分数')}}</th>
                                        <th><i class="red">*</i>{{$l('有效期从')}}</th>
                                        <th><i class="red">*</i>{{$l('有效期至')}}</th>
                                        <th>{{$l('附件')}}</th>
                                        <th>{{$l('操作人')}}</th>
                                        <th>{{$l('更新时间')}}</th>
                                        <th>{{$l('操作')}}</th>
                                        <!--属性/供应商档案号*/供应商名称/品类*/分数*/结果*/有效期从*/有效期至*-->
                                        <!--附件/操作人/更新时间-->
                                    </tr>
                                    </thead>
                                    <tbody ng-show="dataTable.data">
                                    <tr class="text-center" ng-repeat="row in dataTable.data"
                                        ng-class="{'active':dataTable.data.selectRow==$index}"
                                        ng-click="dataTable.data.selectRow=$index;
                                        dataTable.data.selectRowData =row;">

                                        <td ng-bind="$index+1" class="w50">1</td>
                                        <td>{{$l('年度Commercial contract审核')}}</td>
                                        <!--属性/供应商档案号*/供应商名称/品类*/分数*/结果*/有效期从*/有效期至*-->
                                        <!--附件/操作人/更新时间-->
                                        <td>
                                            <div class="input-group input-group-xs" style="width: 150px;">
                                                <input type="text" class="form-control radius3"
                                                       name="supplierNumber"
                                                       ng-model="row.supplierNumber" required readonly>
                                                <span class="input-group-btn">
                                                <button class="btn btn-default" ng-click="selectSupplierInfo($index)"
                                                        type="button" ng-disabled="!editFlag">
                                                    <i class="fa fa-search"></i></button></span>
                                            </div>
                                        </td>
                                        <td>{{row.supplierName}}</td>
                                        <td><input type="number" class="form-control radius3" style="width: 50px;"
                                                   placeholder="" ng-model=row.score ng-readonly="!editFlag"
                                                   step="1" min="0"
                                                   οnkeyup="this.value= this.value.match(/\d+(\.\d{0,2})?/) ? this.value.match(/\d+(\.\d{0,2})?/)[0] : ''"
                                        ></td>
                                        <td><input type="text" class="form-control radius3" style="width: 150px;"
                                                   date-time-picker data-date-format="yyyy-mm-dd"
                                                   data-enddate="{{row.endValidDate}}"
                                                   data-min-View="2" placeholder="" ng-model=row.beginValidDate
                                                   ng-disabled="!editFlag" required
                                        ></td>
                                        <td><input type="text" class="form-control radius3" style="width: 150px;"
                                                   date-time-picker data-date-format="yyyy-mm-dd"
                                                   data-startDate="{{row.beginValidDate}}"
                                                   data-min-View="2" placeholder="" ng-model=row.endValidDate
                                                   ng-disabled="!editFlag" required
                                        ></td>
                                        <td class="text-left">
                                            <div class="btn-group btn-group-xs" style="">
                                                <input type="file" name="file2" data-attr-id="{{$index}}"
                                                       ng-if="row.fileId==null || row.fileId == ''"
                                                       emms-file-upload="myFile2"
                                                       onchange="angular.element(this).scope().fileUploadForLine(this)"
                                                       ng-disabled="!editFlag">
                                                <span class="input-group-addon bn"
                                                      ng-if="row.fileId != null && row.fileId != ''"
                                                      style="width: 230px;text-align: left;height:23px;display:inline-block;">
                                                    <a class="ellipsis" style="color:blue;display: block;width: 220px;"
                                                       href="{{row.filePath}}"
                                                       target="_blank">{{row.fileName}}
                                                    </a>&nbsp;&nbsp;
                                            </span>
                                            </div>
                                            <div class="btn-group btn-group-xs" style="margin-right: 16px;">
                                                <button type="button" ng-click="changeFileForLine(row)"
                                                        class="btn btn-primary btn-xs"
                                                        ng-if="row.fileId != null && row.fileId != '' && editFlag== true">
                                                    <i class="fa fa-plus">{{$l('重新上传')}}</i>
                                                </button>
                                            </div>
                                        </td>
                                        <td>{{row.userFullName}}</td>
                                        <td>{{row.lastUpdateDate}}</td>
                                        <td>
                                            <button class="btn btn-success btn-xs" type="button"
                                                    ng-click="btnDel(row,$index)"
                                                    ng-disabled="headData.docStatus != 'DRAFT'"
                                            ><i class="fa fa-trash fa-lg"></i></button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div saaf-table-tfoot="dataTable" ng-show="dataTable.data.length>0"></div>
                            </div>
                        </div>
                    </form>
                </form>
            </div>
        </div>

        <div lov-list="selectSupplierLov" role="dialog" data-title="查询供应商" id="selectSupplierLov" ng-model=""
             data-url="findSupplierLov"
             data-callback="selectSupplierLov"
             data-dynamic-params=''
             data-params="{'deptCode':'{{editParams.deptCode}}'}"
             data-auto-request="true"
             data-return-type="key"
             data-pagination="{'pageIndex':'1','pageRows':'5'}"
             data-checked-type="radio"
             data-keys="{'key':'supplierNumber','value':'supplierNumber','name':'供应商档案号'}"
             data-other-column="[{'name':'供应商名称','value':'supplierNumber','key':'supplierName'}]"
             data-show-index="false"
             data-type="competitor"
             data-search-key="[{'key':'supplierNumber','placeholder':'供应商档案号','label':'供应商档案号'},
        {'key':'supplierName','placeholder':'供应商名称','label':'供应商名称'}]"
        ></div>
    </div>
</div>