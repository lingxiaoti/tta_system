<div class="bigdata" ng-controller="analysisInitCtrl">
    <div data-api-get="proposalFindById"
         data-api-post="proposalSave"
         data-api-update="proposalSave"
         id="processForm">
    </div>
    <style type="text/css">
        th {
            text-align: center;
        }
        /*************anlysis模块 start**************/


        @media print {
            #dataTable input {
                height: 20px;
            }

            #dataTable {
                text-align: center;
                font: 21px Helvetica Neue,Helvetica,PingFang SC,Tahoma,Arial,sans-serif;
                border: 3px solid #000000 !important;
            }

            #dataTable > thead > tr > th,
            #dataTable > tbody > tr > th,
            #dataTable > tfoot > tr > th,
            #dataTable > thead > tr > td,
            #dataTable > tbody > tr > td,
            #dataTable > tfoot > tr > td {
                padding: 0px;
            }

            #analysisDataTableId {
                text-align: center;
                font: 15px Helvetica Neue,Helvetica,PingFang SC,Tahoma,Arial,sans-serif;
                border: 3px solid #000000 !important;
            }

            #analysisDataTableId > tbody > tr > td{
                text-align: center;
            }

            #anlysis_new_1 th {
                border: 0px solid white !important;
            }

            #anlysis_new_2 th {
                border: 0px solid white !important;
            }

            #analysisDataTableId input {
                height: 20px;
            }

            #analysisDataTableId th, #analysisDataTableId td {
                white-space: nowrap;
            }

            #analysisDataTableId > thead > tr > th,
            #analysisDataTableId > tbody > tr > th,
            #analysisDataTableId > tfoot > tr > th,
            #analysisDataTableId > thead > tr > td,
            #analysisDataTableId > tbody > tr > td,
            #analysisDataTableId > tfoot > tr > td {
                padding: 5px;
            }

        }
        /**************anlysis模块 end**********/


          /*@media print {
              @page {
                  size: A4 portrait; //正向打印
                  size: A4 landscape; //横向打印
              }
              #printTradeId {
                  width: 188%;
                  transform: scale(0.53);
                  -webkit-transform-origin-x: 0;
                  -webkit-transform-origin-y: 0;
                  overflow-y: hidden;
                  overflow-x: hidden;
              }
         }*/

        div {
            font-family: 微软雅黑;
        }

        .spanBold {
            font-weight: bold;
            margin: 5px;
        }

        .divTable {
            float: left;
            width: 49%;
            min-height: 1065px;
            border: 1px solid black;
        }

        .proposalReport {
            background-color: #1e90c2 !important;
        }

        .font {
            font-size: 12px;
        }
        .tdWidth {
            width: 115px;
        }
        .thWidthAndHeight{
            width:35%;
        }

       /* 如下为设置品牌计划颜色 start*/
        .brandHeadThColorAndActual {
            color: #fff;
            background-color: #808080 !important;
        }

        .brandHeadThColorAndFuture {
            color: #fff;
            background-color: #4F6228 !important;
        }

        .brandLineInfoColor {
            color: #fff;
            background-color:#919191 !important;
        }

        .brandLineContentBrandInfo {
            background-color: #BFBFBF !important;
        }

        .brandLineContentActual {
            background-color: #EAEAEA !important;
        }
        .brandLineContentFuture {
            background-color: #D8E4BC !important;
        }
        /* 如下为设置品牌计划颜色 end*/

        .analysis-row-bg-1 {
            background-color: #F5FFFA !important;
        }

        .analysis-row-bg-2 {
            background-color: #D3FF93 !important
        }

        .analysis-row-bg-3 {
            background-color: #D8D8EB !important;
        }
        .analysis-row-font-weight {
            font-weight: bold !important;
        }

    </style>

    <div data-des="此节点必需－用户计算滚动区域高度" main-scroll-style>
        <div class="nicescroll-height  bg-white" data-des="此节点必需-滚动内容及指令">
            <div class="col-xs-12 col-md-12 br p0">
                <div >
                 <a style="text-decoration:none" id="printPDFirst" ng-show="printPDFFlag">&nbsp;</a>
                <a style="text-decoration:none" data-toggle="tab" href="#termsNewAnalysis" ng-click="tabChangeInfo('termsNewAnalysis')"><span id="printPDFNewAnalysis">&nbsp;</span></a>
                </div>
                <div class="tab-content" id="tabContent">
                <!--ttaAnalysis测试 开始-->
                <div class="tab-pane fade in active col-md-12" id="termsNewAnalysis">
                    <div main-scroll-style data-des="此节点必需－用户计算滚动区域高度">
                        <div class="nicescroll-height  bg-white" data-des="此节点必需-滚动内容及指令">

                            <div class="data-table">

                                <div style="" id="nicescrolNewAlnlysisMain" main-scroll-style>
                                    <div class="nicescroll-height"  id="nicescroll_dataTable_test"
                                    >
                                        <table id = "analysisDataTableId"
                                               class=" nicescroll-height table-bordered table-hover">
                                            <thead>
                                                <tr id="anlysis_new_1" style="background: white !important;" class="text-center">
                                                    <th rowspan="2" style="width: 80px; border: 0px solid #ddd" align="left">Batch：</th>
                                                    <th rowspan="2" style="width: 150px; border: 0px solid #ddd" align="left">{{analysisHeader.batchNumber}}</th>
                                                    <th colspan="3" rowspan="2" style="border: 0px solid #ddd"></th>
                                                    <th colspan="3" rowspan="2" style="border: 0px solid #ddd"><font size="5">{{proposalNewYear}} TTA Terms Analysis</font></th>
                                                    <th rowspan="2" colspan="10"></th>
                                                    <th style="border-right: 3px solid #000000 !important;"></th>
                                                </tr>

                                                <tr  id="anlysis_new_2" style="background: white !important;" class="text-center">
                                                    <th style="border-right: 3px solid #000000 !important;"></th>
                                                </tr>
                                            </thead>

                                            <tr  id="anlysis_new_3" style="background:#D8D8EB !important;height: 3px;border-top:3px solid black !important;"  class="text-center" >
                                                <th colspan="13"></th>
                                                <th colspan="6" style="border-right: 3px solid #000000 !important;"><font size="1" style="height: 3px">{{proposalNewYear}} TTA versus {{proposalNewYear-1}} TTA</font></th>
                                            </tr>

                                            <tr id="anlysis_new_4"  style="background:#D8D8EB !important;" class="text-center">
                                                <th>Supplier code</th>
                                                <th>Supplier name</th>
                                                <th>Region</th>
                                                <th>Class</th>
                                                <th>Buyer</th>
                                                <th>Owner Dept</th>
                                                <th>Trading mode</th>
                                                <th>Contract<br/>Version</th>
                                                <th colspan="2">Brand</th>
                                                <th>New or Existing<br/>(N/E)</th>
                                                <th>{{proposalNewYear}}Forecast<br/>Purchase(k)</th>
                                                <th>Purchase<br/>+/-%</th>
                                                <th>GP% <br/>+/-%</th>
                                                <th>BEOI% <br/>+/-%</th>
                                                <th>SROI% <br/>+/-%</th>
                                                <th>ABOI% <br/>+/-%</th>
                                                <th>TotalOI%<br/>+/-%</th>
                                                <th style="border-right: 3px solid #000000 !important;">NM%<br/>+/-%</th>
                                            </tr>
                                            <tr id="anlysis_new_5" style="background:lightyellow !important;border-bottom:3px solid black !important;" class="text-center">
                                                <th align="left">{{analysisHeader.supplierCode}}</th>
                                                <th align="left">{{analysisHeader.supplierName}}</th>
                                                <th style="white-space: normal;">{{analysisHeader.region}}</th>
                                                <th>{{analysisHeader.classs}}</th>
                                                <th>{{analysisHeader.buyer}}</th>
                                                <th>{{analysisHeader.ownerDept}}</th>
                                                <th style="white-space: normal">{{analysisHeader.tradingMode}}</th>
                                                <th>{{analysisHeader.contractVersion}}</th>
                                                <th colspan="2" style="white-space: normal">{{analysisHeader.brand}}</th>
                                                <th>{{analysisHeader.newOrExisting}}</th>
                                                <th>{{analysisHeader.forecastPurchase | number:0}}</th>
                                                <th>{{analysisHeader.purchase | number:2 | changeNumberToPosiNumber}}%</th>
                                                <th>{{analysisHeader.gp | number:2 | changeNumberToPosiNumber}}%</th>
                                                <th>{{analysisHeader.beoi | number:2 | changeNumberToPosiNumber}}%</th>
                                                <th>{{analysisHeader.sroi | number:2 | changeNumberToPosiNumber}}%</th>
                                                <th>{{analysisHeader.aboi | number:2 | changeNumberToPosiNumber}}%</th>
                                                <th>{{analysisHeader.totaloi | number:2 | changeNumberToPosiNumber}}%</th>
                                                <th style="border-right: 3px solid #000000 !important;">{{analysisHeader.nm | number:2 | changeNumberToPosiNumber}}%</th>
                                            </tr>
                                            <!--如下行没用到,故注释-->
                                           <!-- <tr id="anlysistest_6" style="background: white !important;">
                                                <th style="display:table-cell; vertical-align:middle;border-right: 3px solid #000000 !important;" colspan="19" rowspan="2"  >{{header.remark}}</th>
                                            </tr>-->
                                            <tr id="anlysis_new_6" style="background: white !important;border: 3px solid #000000 !important;height: 10px" class="text-center">
                                                <td colspan="19" style="border-right: 3px solid #000000 !important;"></td>
                                            </tr>
                                            <tr id="anlysis_new_7" style="background:#D8D8EB !important; border-top:3px solid black !important;">
                                                <th  width="300px" style="border-right: 3px solid #000000 !important;display:table-cell; vertical-align:middle;text-align: center" colspan="3" rowspan="3" >
                                                    <div>
                                                        <font style="width: 200px">Terms Comparison</font><br/><br/>
                                                        <font style="width: 200px">('000 RMB, w/ VAT, w/ Markup)</font>
                                                    </div>
                                                </th>
                                                <th colspan="4" style="border-right: 3px solid #000000 !important;">{{proposalNewYear-1}}</th>
                                                <th colspan="3" style="border-right: 3px solid #000000 !important;">{{proposalNewYear}}</th>
                                                <th colspan="4" style="border-right: 3px solid #000000 !important;">YOY Comparison</th>
                                                <th style="display:table-cell; vertical-align:middle;text-align: center;border-right: 3px solid #000000 !important;" colspan="7" rowspan="3">Remark</th>
                                            </tr>
                                            <tr id="anlysis_new_8" style="background:#D8D8EB !important;" class="text-center">
                                                <th rowspan="2">{{proposalNewYear-1}}<br/>TTA</th>
                                                <th rowspan="2">{{proposalNewYear-1}}<br/>On Top</th>
                                                <th rowspan="2">{{proposalNewYear-1}}<br/>TTA+On Top</th>
                                                <th rowspan="2" style="border-right: 3px solid #000000 !important;">{{proposalNewYear-1}}<br/>Actual</th>
                                                <th rowspan="2">{{proposalNewYear}}<br/>TTA</th>
                                                <th rowspan="2" >{{proposalNewYear}}<br/>On Top</th>
                                                <th rowspan="2" style="border-right: 3px solid #000000 !important;">{{proposalNewYear}}<br/>TTA+On Top</th>
                                                <th colspan="2">{{proposalNewYear}} TTA+On Top vs<br/>{{proposalNewYear-1}} TTA+On Top</th>
                                                <th colspan="2">{{proposalNewYear}}TTA+OnTop vs<br/>{{proposalNewYear-1}}Act</th>
                                            </tr>
                                            <tr id="anlysis_new_9" style="background:#D8D8EB !important;" class="text-center">
                                                <th>+/-$</th>
                                                <th>+/-%</th>
                                                <th>+/-$</th>
                                                <th>+/-%</th>
                                            </tr>

                                            <!--ng-style="{'background-color':($index == 0 || $index == 4) ? '#D3FF93 !important':'#F5FFFA !important'}"-->
                                            <tr id="analysisId_topPart1_{{$index}}" ng-class="{'analysis-row-bg-2':($index == 0 || $index == 4),'analysis-row-bg-1':($index != 0 && $index != 4)}"  style="font-weight: bold" ng-repeat="row in analysisLineTopPart1 track by $index" >
                                                <td colspan="3" align="left" style="border-right: 3px solid #000000 !important;">{{row.termsComparison}}</td>

                                                <td ng-if="$index == 0 || $index == 4">{{row.formerYearTta | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4">{{row.formerYearOntop | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4">{{row.formerYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4" style="border-right: 3px solid #000000 !important;">{{row.formerYearActual | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4">{{row.currentYearTta | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4" >{{row.currentYearOntop | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4" style="border-right: 3px solid #000000 !important;">{{row.currentYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == 0 || $index == 4">{{row.ttaOntopIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == 0 || $index == 4">{{row.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == 0 || $index == 4">{{row.ttaOntopActIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == 0 || $index == 4" style="border-right: 3px solid #000000 !important;">{{row.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index > 1 && $index < 4 ">{{row.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4">{{row.formerYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4">{{row.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4" style="border-right: 3px solid #000000 !important;">{{row.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4">{{row.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4" >{{row.currentYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4" style="border-right: 3px solid #000000 !important;">{{row.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4">{{row.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4">{{row.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber }}%</td>
                                                <td ng-if="$index > 1 && $index < 4">{{row.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index > 1 && $index < 4" style="border-right: 3px solid #000000 !important;">{{row.ttaOntopActPercentGain | changeNumberToPosiNumber | number:2}}%</td>

                                                <td ng-if="$index == 1">{{row.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 1">
                                                    <input style="text-align: center; background: white !important;" type="text" class="form-control radius3"
                                                           maxlength="255" ng-model="row.formerYearOntop" to-change-number >
                                                </td>
                                                <td ng-if="$index == 1">{{row.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 1" style="border-right: 3px solid #000000 !important;">{{row.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 1">{{row.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 1" >
                                                    <input style="text-align: center; background: white !important;" type="text" class="form-control radius3"
                                                           maxlength="255" ng-model="row.currentYearOntop" to-change-number >
                                                </td>
                                                <td ng-if="$index == 1" style="border-right: 3px solid #000000 !important;">{{row.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 1">{{row.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == 1">{{row.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == 1">{{row.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == 1" style="border-right: 3px solid #000000 !important;">{{row.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index == 0" colspan="7" rowspan="8" style="background:mistyrose !important;border-right: 3px solid #000000 !important;" >
                                                    <textarea id="premarkp" style="width: 100%;height: 100%;background: #FFFFFF !important" ng-model="analysisHeader.purchaseRemark"></textarea>
                                                </td>
                                            </tr>

                                            <tr  style="height: 13px">
                                                <td colspan="14" style="border: 2px solid #000000 !important;"></td>
                                            </tr>

                                            <!-- ng-style="{'background-color':($index == 0) ? '#F5FFFA !important':'#D3FF93 !important'}"-->
                                            <tr id="analysisId_topPart2_{{$index}}" ng-class="{'analysis-row-bg-1': ($index == 0),'analysis-row-bg-2':$index != 0}"  style="font-weight: bold" ng-repeat="rowPart2 in analysisLineTopPart2 track by $index">
                                                <td colspan="3" align="left" style="border-right: 3px solid #000000 !important;">{{rowPart2.termsComparison}}</td>

                                                <td ng-if="$index == 0">{{rowPart2.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{rowPart2.formerYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{rowPart2.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" style="border-right: 3px solid #000000 !important;">{{rowPart2.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{rowPart2.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{rowPart2.currentYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" style="border-right: 3px solid #000000 !important;">{{rowPart2.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{rowPart2.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{rowPart2.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == 0">{{rowPart2.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" style="border-right: 3px solid #000000 !important;">{{rowPart2.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index == 1">{{rowPart2.formerYearTta | number:2}}%</td>
                                                <td ng-if="$index == 1">{{rowPart2.formerYearOntop | number:2}}%</td>
                                                <td ng-if="$index == 1">{{rowPart2.formerYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == 1" style="border-right: 3px solid #000000 !important;">{{rowPart2.formerYearActual | number:2}}%</td>
                                                <td ng-if="$index == 1">{{rowPart2.currentYearTta | number:2}}%</td>
                                                <td ng-if="$index == 1">{{rowPart2.currentYearOntop | number:2}}%</td>
                                                <td ng-if="$index == 1" style="border-right: 3px solid #000000 !important;">{{rowPart2.currentYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == 1">{{rowPart2.ttaOntopIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == 1">{{rowPart2.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == 1">{{rowPart2.ttaOntopActIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == 1" style="border-right: 3px solid #000000 !important;">{{rowPart2.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                            </tr>

                                            <!--BEOI类型的条款-->
                                            <!-- ng-style="{'background-color': ($index == analysisLineBeoi.length - 1) ? '#D3FF93 !important':'none','font-weight':($index == analysisLineBeoi.length - 1 || $index == analysisLineBeoi.length - 2) ? 'bold':'normal'}"-->
                                            <tr id="analysisId_beoi_{{$index}}" ng-repeat="beoiRow in analysisLineBeoi track by $index" ng-class="{'analysis-row-bg-2':($index == analysisLineBeoi.length - 1),'analysis-row-font-weight':($index == analysisLineBeoi.length - 1 || $index == analysisLineBeoi.length - 2)}">
                                                <td ng-if="$index == 0" rowspan="{{analysisLineBeoi.length}}">{{beoiRow.oiType}}</td>

                                                <td ng-if="$index != analysisLineBeoi.length-1 && $index != analysisLineBeoi.length-2" style="text-align: left">{{beoiRow.termsEn}}</td>
                                                <td ng-if="$index != analysisLineBeoi.length-1 && $index != analysisLineBeoi.length-2" style="border-right: 3px solid #000000 !important;text-align: left;">{{beoiRow.termsCn}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length-1 || $index == analysisLineBeoi.length-2" colspan="2" style="border-right: 3px solid #000000 !important;text-align: center;">{{beoiRow.termsComparison}}</td>

                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.formerYearTta | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.formerYearOntop | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.formerYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2" style="border-right: 3px solid #000000 !important;">{{beoiRow.formerYearActual | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.currentYearTta | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.currentYearOntop | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2" style="border-right: 3px solid #000000 !important;">{{beoiRow.currentYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.ttaOntopIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2">{{beoiRow.ttaOntopActIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index != analysisLineBeoi.length-2" style="border-right: 3px solid #000000 !important;">{{beoiRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.formerYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2" style="border-right: 3px solid #000000 !important;">{{beoiRow.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.currentYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2" style="border-right: 3px solid #000000 !important;">{{beoiRow.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2">{{beoiRow.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == analysisLineBeoi.length - 2" style="border-right: 3px solid #000000 !important;">{{beoiRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index == 0 && (controllTabShow.remarkFlag || params.status == 'C')" colspan="7" rowspan="{{analysisLineBeoi.length + analysisLineSroi.length + analysisLineAboi.length}}" style="border-right: 3px solid !important;">
                                                    <strong><textarea id='bicremark' style='width: 100%;height: 100%'>{{analysisHeader.bicRemark}}</textarea></strong>
                                                </td>
                                                <td ng-if="$index == 0 && (!controllTabShow.remarkFlag && params.status != 'C')" colspan="7" rowspan="{{analysisLineBeoi.length + analysisLineSroi.length + analysisLineAboi.length}}" style="border-right: 3px solid !important;">
                                                    <strong><textarea id='bicremark' style='width: 100%;height: 100%' ng-model="analysisHeader.bicRemark"></textarea></strong>
                                                </td>
                                            </tr>

                                            <!--SROI类型的条款-->
                                            <!-- ng-style="{'background-color': ($index == analysisLineSroi.length - 1) ? '#D3FF93 !important':'none','font-weight':($index == analysisLineSroi.length - 1 || $index == analysisLineSroi.length - 2) ? 'bold':'normal'}"-->
                                            <tr id="analysisId_sroi_{{$index}}" ng-repeat="sroiRow in analysisLineSroi track by $index" ng-class="{'analysis-row-bg-2': ($index == analysisLineSroi.length - 1),'analysis-row-font-weight':($index == analysisLineSroi.length - 1 || $index == analysisLineSroi.length - 2)}">
                                                <td ng-if="$index == 0" rowspan="{{analysisLineSroi.length}}">{{sroiRow.oiType}}</td>

                                                <td ng-if="$index != analysisLineSroi.length-1 && $index != analysisLineSroi.length-2" style="text-align: left">{{sroiRow.termsEn}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1 && $index != analysisLineSroi.length-2" style="border-right: 3px solid #000000 !important;text-align: left;white-space: normal">
                                                    <div style="width: 280px;word-break: break-all;">{{sroiRow.termsCn}}</div>
                                                </td>
                                                <td ng-if="$index == analysisLineSroi.length-1 || $index == analysisLineSroi.length-2" colspan="2" style="border-right: 3px solid #000000 !important;text-align: center;">{{sroiRow.termsComparison}}</td>

                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.formerYearTta | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.formerYearOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.formerYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1" style="border-right: 3px solid #000000 !important;:">{{sroiRow.formerYearActual | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.currentYearTta | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.currentYearOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1" style="border-right: 3px solid #000000 !important;">{{sroiRow.currentYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.ttaOntopIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == analysisLineSroi.length-1">{{sroiRow.ttaOntopActIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == analysisLineSroi.length-1" style="border-right: 3px solid #000000 !important;">{{sroiRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.formerYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1" style="border-right: 3px solid #000000 !important;">{{sroiRow.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.currentYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1" style="border-right: 3px solid #000000 !important;">{{sroiRow.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber |zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index != analysisLineSroi.length-1">{{sroiRow.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber |zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineSroi.length-1" style="border-right: 3px solid #000000 !important;">{{sroiRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                            </tr>

                                            <!--ABOI类型的条款-->
                                            <!-- ng-style="{'background-color': ($index == analysisLineAboi.length - 1) ? '#D3FF93 !important':'none','font-weight':($index == analysisLineAboi.length - 1 || $index == analysisLineAboi.length - 2) ? 'bold':'normal'}"-->
                                            <tr id="analysisId_aboi_{{$index}}"  ng-repeat="aboiRow in analysisLineAboi track by $index" ng-class="{'analysis-row-bg-2': ($index == analysisLineAboi.length - 1),'analysis-row-font-weight': ($index == analysisLineAboi.length - 1 || $index == analysisLineAboi.length - 2)}" >
                                                <td ng-if="$index == 0" rowspan="{{analysisLineAboi.length}}">{{aboiRow.oiType}}</td>

                                                <td ng-if="$index != analysisLineAboi.length-1 && $index != analysisLineAboi.length-2" style="text-align: left">{{aboiRow.termsEn}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1 && $index != analysisLineAboi.length-2" style="border-right: 3px solid #000000 !important;text-align: left;">{{aboiRow.termsCn}}</td>
                                                <td ng-if="$index == analysisLineAboi.length-1 || $index == analysisLineAboi.length-2" colspan="2" style="border-right: 3px solid #000000 !important;text-align: center;">{{aboiRow.termsComparison}}</td>

                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.formerYearTta | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.formerYearOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.formerYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1" style="border-right: 3px solid #000000 !important;:">{{aboiRow.formerYearActual | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.currentYearTta | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.currentYearOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1" style="border-right: 3px solid #000000 !important;">{{aboiRow.currentYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.ttaOntopIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == analysisLineAboi.length-1">{{aboiRow.ttaOntopActIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index == analysisLineAboi.length-1" style="border-right: 3px solid #000000 !important;">{{aboiRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index != analysisLineAboi.length-1">{{aboiRow.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1 && $index != analysisLineAboi.length-2">
                                                    <input type='text' style='width: 100%;text-align: center;'  class='form-control radius3' ng-model="aboiRow.formerYearOntop"
                                                           to-change-number >
                                                </td>
                                                <td ng-if="$index == analysisLineAboi.length-2">{{aboiRow.formerYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1">{{aboiRow.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1" style="border-right: 3px solid #000000 !important;">{{aboiRow.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1">{{aboiRow.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1 && $index != analysisLineAboi.length-2">
                                                    <input type='text' style='width: 100%;text-align: center;'  class='form-control radius3' ng-model="aboiRow.currentYearOntop"
                                                    to-change-number >
                                                </td>
                                                <td ng-if="$index == analysisLineAboi.length-2">{{aboiRow.currentYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1" style="border-right: 3px solid #000000 !important;">{{aboiRow.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1">{{aboiRow.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1">{{aboiRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index != analysisLineAboi.length-1">{{aboiRow.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index != analysisLineAboi.length-1" style="border-right: 3px solid #000000 !important;">{{aboiRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                            </tr>

                                            <!--analysis底部数据-->
                                            <tr id="analysisId_bottom_{{$index}}" ng-class="{'analysis-row-bg-1':$index == 0,'analysis-row-bg-2':($index != 0 && $index != analysisLineBottomPart.length - 1),'analysis-row-bg-3':$index == analysisLineBottomPart.length - 1}" style="font-weight: bold !important;"  ng-repeat="bottomRow in analysisLineBottomPart track by $index">
                                                <td colspan="3" align="left" style="border-right: 3px solid #000000 !important;">{{bottomRow.termsComparison}}</td>
                                                <td ng-if="$index == 0 ">{{bottomRow.formerYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{bottomRow.formerYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{bottomRow.formerYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" style="border-right: 3px solid #000000 !important;">{{bottomRow.formerYearActual | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{bottomRow.currentYearTta | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" >{{bottomRow.currentYearOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" style="border-right: 3px solid #000000 !important;">{{bottomRow.currentYearTtaOntop | number:0 | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{bottomRow.ttaOntopIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == 0">{{bottomRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index == 0">{{bottomRow.ttaOntopActIncreAmt | number:0 | changeNumberToPosiNumber | zeroToStriping}}</td>
                                                <td ng-if="$index == 0" style="border-right: 3px solid #000000 !important;">{{bottomRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index != 0">{{bottomRow.formerYearTta | number:2}}%</td>
                                                <td ng-if="$index != 0">{{bottomRow.formerYearOntop | number:2}}%</td>
                                                <td ng-if="$index != 0">{{bottomRow.formerYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index != 0" style="border-right: 3px solid #000000 !important;">{{bottomRow.formerYearActual | number:2}}%</td>
                                                <td ng-if="$index != 0">{{bottomRow.currentYearTta | number:2}}%</td>
                                                <td ng-if="$index != 0" >{{bottomRow.currentYearOntop | number:2}}%</td>
                                                <td ng-if="$index != 0" style="border-right: 3px solid #000000 !important;">{{bottomRow.currentYearTtaOntop | number:2}}%</td>
                                                <td ng-if="$index != 0">{{bottomRow.ttaOntopIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index != 0">{{bottomRow.ttaOntopPercentGain | number:2 | changeNumberToPosiNumber}}%</td>
                                                <td ng-if="$index != 0">{{bottomRow.ttaOntopActIncreAmt | number:0 | zeroToNa}}</td>
                                                <td ng-if="$index != 0" style="border-right: 3px solid #000000 !important;">{{bottomRow.ttaOntopActPercentGain | number:2 | changeNumberToPosiNumber}}%</td>

                                                <td ng-if="$index == 0 && userData.userType == '45'" style="background:mistyrose !important;border-right: 3px solid !important;" colspan="7" rowspan="3"></td>
                                                <td ng-if="$index == analysisLineBottomPart.length - 1 && userData.userType == '45'" style="background:mistyrose !important;border-right: 3px solid !important;text-align: left" colspan="7" align="left">{{analysisHeader.benchMark}}</td>
                                            </tr>

                                            <tr id="analysisId_prepared" style="background:white !important;border-right: 3px solid !important;border-top: 3px solid !important;font-weight: bold" >
                                                <td  align="left" style="vertical-align: middle; border-bottom:3px solid black !important;">Prepared by BIC:</td>
                                                <td style="background:white;height: 80px;border-bottom:3px solid black !important;" colspan="8"></td>
                                                <td style="vertical-align: middle;border-bottom:3px solid black !important;">Approved by:</td>
                                                <td style="background:white;height: 80px;border-bottom:3px solid black !important;" colspan="12" align="left"></td>
                                            </tr>

                                        </table>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>

                            <!--endprint-->

                        </div>
                    </div>

                </div>
                <!--ttaAnalysis测试 结束-->


            </div>
            <!-- tabContent -->
        </div>
    </div>
</div>
</div>

