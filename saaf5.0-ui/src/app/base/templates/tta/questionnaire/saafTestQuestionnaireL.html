<div ng-controller="saafTestQuestionnaireLCtrl" class="gridtable">

    <style>
        .lineListInfo {
            padding: 10px;
            margin-bottom: 5px;
        }

        .qnDetail .lineListInfo:active {
            border: 1px solid #00a0e9;
        }

        .qnDetail .active{
            border: 1px solid #00a0e9;
        }
    </style>

    <div class="form bg-white" inner-frame data-des="此节点必需－内框页面的指令">
        <div>
            <!--------------------- 按钮--->
            <div class="bg-gray-white bt">
                <div class="bg-gray-white p5">
                    <div class="btn-group btn-group-xs pull-right ml10" id="outputButton">
                        <!--ng-if="allowUpdate"-->

                        <button type="button" class="btn btn-default" ng-click="add()"><i class="fa fa-plus"></i>新增
                        </button>
                        <!--<button type="button" class="btn btn-default" ng-disabled="selectRow==null" ng-click="edit()"><i-->
                                <!--class="fa fa-pencil"></i>修改-->
                        <!--</button>-->
                        <button type="button" class="btn btn-default" ng-disabled="selectRow==null" ng-click="delete()"><i
                                class="fa fa-close"></i>删除
                        </button>
                    </div>

                    <div class="btn-group btn-group-xs ">
                        <button type="button" class="btn btn-primary" ng-click="fullWindow($event)"><i
                                class="fa fa-square-o"></i>数据全屏
                        </button>
                    </div>
                </div>
            </div>
            <!---------------------  / .按钮  --->
            <div main-scroll-style data-des="此节点必需－用户计算滚动区域高度">
                <div class="nicescroll-height  bg-white " ng-nicescroll
                     nice-option="{cursorcolor: '#998279',cursorwidth:10}" data-des="此节点必需-滚动内容及指令">
                    <div style="padding:20px 30px;">
                        <div ng-if="allowUpdate" class="qnDetail" style="padding:20px;border: 1px dashed #ddd;">
                            <p class="text-center">
                                <strong style="font-size: 24px;">{{headList.qnTitle}}</strong>
                                <span style="font-size: 14px;padding-left: 10px;">{{headList.qnCode}}</span>
                            </p>

                            <p style="padding-top: 10px;padding-left: 10px;font-size: 16px;">{{headList.description}}</p>

                            <div  class="lineListInfo" ng-repeat="item in lineList"
                                  ng-class="{'active':selectRow==$index}"
                                  ng-click="getSelectRow($index)">
                                <div>
                                    <p><span style="color:red;" ng-show="item.requireFlag=='Y'">*</span>
                                        Q{{$index+1}}：{{item.projectTitle}}</p>
                                    <!--不同题型不同的状态-->
                                    <p ng-show="item.projectType=='text'" ng-repeat="subItem in item.choiceList">
                                        <!--输入框使用-->
                                        <input type="text" style="max-width: 500px;" class="form-control radius3"
                                               ng-model="subItem.qnChoiceContent">
                                    </p>
                                    <p ng-show="item.projectType=='textarea'" ng-repeat="subItem in item.choiceList">
                                        <textarea style="height:100%;max-width: 500px;" rows="5" class="form-control radius3"
                                                  ng-model="subItem.qnChoiceContent"></textarea>
                                    </p>
                                    <p ng-show="item.projectType=='single_selection'" ng-repeat="subItem in item.choiceList">
                                        <!--单选框使用-->
                                        <input type="radio" name="{{item.testQnLineId}}">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                    <p ng-show="item.projectType=='multi_selection'" ng-repeat="subItem in item.choiceList">
                                        <!--复选框使用-->
                                        <input type="checkbox" name="{{item.testQnLineId}}">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                    <p ng-show="item.projectType=='drop_down_list'">
                                        <!--下拉框使用-->
                                        <select class="form-control radius3" style="width: 500px;">
                                            <option ng-repeat="subItem in item.qnChoiceData" value="{{subItem.qnChoiceContent}}">
                                                {{subItem.qnChoiceContent}}
                                            </option>
                                        </select>
                                    </p>

                                    <p ng-show="item.projectType=='single_selection_skip'" ng-repeat="subItem in item.choiceList">
                                        <!--跳转使用-->
                                        <input type="radio" name="{{item.testQnLineId}}">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                    <p ng-show="item.projectType=='single_selection_show'" ng-repeat="subItem in item.choiceList">
                                        <!--显示使用-->
                                        <input type="radio" name="{{item.testQnLineId}}">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div ng-if="!allowUpdate" style="padding:20px;border: 1px dashed #ddd;">
                            <p class="text-center">
                                <strong style="font-size: 24px;">{{headList[0].qnTitle}}</strong>
                                <span style="font-size: 14px;padding-left: 10px;">{{headList[0].qnCode}}</span>
                            </p>

                            <p style="padding-top: 10px;padding-left: 10px;font-size: 16px;">{{headList[0].description}}</p>

                            <div class="lineListInfo" ng-repeat="(itemIndex,item) in lineList"
                                 ng-class="{'active':selectRow==$index}"
                                 ng-click="getSelectRow($index)">
                                <div ng-show="item.showFlag">
                                    <p><span style="color:red;" ng-show="item.requireFlag=='Y'">*</span>
                                        Q{{$index+1}}：{{item.projectTitle}}</p>
                                    <!--不同题型不同的状态-->
                                    <p ng-show="item.projectType=='text'" ng-repeat="subItem in item.qnChoiceData">
                                        <!--输入框使用-->
                                        <input type="text" style="max-width: 500px;" class="form-control radius3" ng-change="changeText(itemIndex,item)"
                                               ng-model="subItem.qnChoiceContent">
                                    </p>
                                    <p ng-show="item.projectType=='textarea'" ng-repeat="subItem in item.qnChoiceData">
                                        <textarea style="height:100%;max-width: 500px;" rows="5" class="form-control radius3"
                                                  ng-model="subItem.qnChoiceContent"></textarea>
                                    </p>
                                    <p ng-show="item.projectType=='single_selection'" ng-repeat="subItem in item.qnChoiceData" >
                                        <!--单选框使用-->
                                        <input type="radio" name="{{item.testQnLineId}}">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                    <p ng-show="item.projectType=='multi_selection'" ng-repeat="subItem in item.qnChoiceData">
                                        <!--复选框使用-->
                                        <input type="checkbox" name="{{item.testQnLineId}}">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                    <p ng-show="item.projectType=='drop_down_list'">
                                        <!--下拉框使用-->
                                        <select class="form-control radius3" style="width: 500px;">
                                            <option ng-repeat="subItem in item.qnChoiceData" value="{{subItem.qnChoiceContent}}">
                                                {{subItem.qnChoiceContent}}
                                            </option>
                                        </select>
                                    </p>
                                    <p ng-show="item.projectType=='single_selection_skip'" ng-repeat="subItem in item.qnChoiceData">
                                        <!--跳转使用-->
                                        <input type="radio" name="{{item.testQnLineId}}"  ng-click="changeRadioSkip(itemIndex,subItem)">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                    <p ng-show="item.projectType=='single_selection_show'" ng-repeat="subItem in item.qnChoiceData">
                                        <!--显示使用-->
                                        <input type="radio" name="{{item.testQnLineId}}" ng-click="changeRadioShow(itemIndex,subItem)">
                                        {{subItem.qnChoice}}：{{subItem.qnChoiceContent}}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="qnLov1" tabindex="-1" role="dialog" aria-labelledby="lovFormModal"
         aria-hidden="true">
        <div class="modal-dialog" style="margin-top: 30px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">选择问题</h4>
                </div>
                <div class="modal-body">
                    <div class=" mt10 pb5  bb oh" input-form data-des="此节点必需－内框页面的指令" style="border-bottom:none;">
                    <form ng-submit="">
                        <div class="form-group col-xs-8 col-md-6">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span class="w100">问题</span></label>
                                <input type="text" class="form-control radius3" ng-model="lineParams.projectTitle" placeholder="">
                            </div>
                        </div>

                        <div class="form-group col-xs-2 col-md-2">
                            <button type="submit" class="btn btn-xs btn-default pull-left" ng-click="searchData()">
                                <i class="fa fa-search" aria-hidden="true"></i>
                            </button>
                        </div>
                    </form>
                </div>
                <div class="data-table">
                    <table saaf-table="formTable"
                           data-url="findQuestionnaireLAndQuestionnaireChoice"
                           data-params='lineParams'
                           data-page-rows="10"
                           data-auto-get-data="true"
                           class="table table-bordered table-hover table-condensed">
                        <thead class="bg-gray-white">
                        <tr class="text-center">
                            <th class="w30"><input type="checkbox" ng-model="allCheckForm" ng-click="selectAll(formTable.data)"/></th>
                            <th class="w50">序号</th>
                            <th>问题</th>
                            <th>问题类型</th>
                            <th>是否必须</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="row in formTable.data">
                                <td><input type="checkbox" ng-model="row.checkForm"
                                    ng-disabled="row.requireFlag==='Y'" ng-checked="row.checked" ng-click="checkBoxActForm(row)"/></td>
                                <td ng-bind="(formTable.curIndex-1)*formTable.pageSize+$index+1" class="w50">1</td>
                                <td>{{row.projectTitle}}</td>
                                <td>{{row.projectType}}</td>
                                <td>{{row.requireFlag}}</td>
                            </tr>
                        </tbody>
                    </table>
                    <div saaf-table-tfoot="formTable"></div>
                    <div class="modal-footer">
                        <div style="text-align:center">
                            <button type="button" class="btn btn-default " data-dismiss="modal"
                                    ng-click="cancelForm()">取消
                            </button>
                            <button type="button" class="btn btn-primary " data-dismiss="modal"
                                    ng-click="saveForm()">保存
                            </button>
                        </div>
                    </div>

                </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="myModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel"
         aria-hidden="true">
        <!--add by luofu-->
        <form ng-submit="save()">
            <div class="modal-dialog" style="margin-top: 40px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"
                                aria-hidden="true">&times;
                        </button>
                        <h4 class="modal-title">题目编辑</h4>
                    </div>
                    <div class="modal-body " style="overflow: auto;height:500px;">
                        <div class="pl30 pr30">
                            <div class="row">
                                <div class="form-group col-xs-11 col-md-12">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100"><i class="red">*</i> 题目：</span></label>
                                        <textarea rows="3" style="height: 100%;" class="form-control radius3" required
                                                  ng-model="current.projectTitle" ng-readonly="!allowUpdate"
                                                  maxlength="500"></textarea>
                                    </div>
                                </div>
                                <div class="form-group col-xs-11 col-md-12">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100">题目别名：</span></label>
                                        <textarea rows="3" style="height: 100%;" class="form-control radius3"
                                                  ng-model="current.projectTitleAlt" ng-readonly="!allowUpdate"
                                                  maxlength="500"></textarea>
                                    </div>
                                </div>
                                <div class="form-group col-xs-11 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100"><i class="red">*</i> 题目序号：</span></label>
                                        <input type="number" class="form-control radius3"
                                               ng-model="current.serialNumber" ng-readonly="!allowUpdate" required>
                                    </div>
                                </div>
                                <div class="form-group col-xs-11 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100"><i class="red">*</i> 题目类型：</span></label>
                                        <select class="form-control radius3" ng-model="current.projectType" required
                                                ng-disabled="!allowUpdate" ng-change="changeProjectType()">
                                            <option value="single_selection">单选</option>
                                            <option value="multi_selection">多选</option>
                                            <option value="drop_down_list">下拉选项</option>
                                            <option value="text">文本</option>
                                            <option value="textarea">多行文本</option>
                                            <option value="single_selection_skip">单选跳转</option>
                                            <option value="single_selection_show">单选显示</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group col-xs-11 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100">是否显示：</span></label>
                                        <input type="checkbox" ng-false-value="'N'" ng-true-value="'Y'"
                                               ng-model="current.displayFlag" ng-readonly="!allowUpdate">
                                    </div>
                                </div>
                                <div class="form-group col-xs-11 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100">是否必填：</span></label>
                                        <input type="checkbox" ng-false-value="'N'" ng-true-value="'Y'"
                                               ng-model="current.requireFlag" ng-readonly="!allowUpdate">
                                    </div>
                                </div>
                                <div class="form-group col-xs-11 col-md-12">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span
                                                class="w100">描述：</span></label>
                                        <textarea rows="3" class="form-control radius3" style="height:100%;"
                                                  ng-model="current.description" ng-readonly="!allowUpdate"
                                                  maxlength="500"></textarea>
                                    </div>
                                </div>


                                <div class="form-group col-xs-11 col-md-12">
                                    <div style="margin-top:10px;">
                                        <label><i class="fa fa-list-alt"></i> 题目选项列表</label>
                                        <button style="margin-right: 5px;" type="button"
                                                class="btn btn-info btn-sm pull-right"
                                                ng-click="addChoice()" ng-disabled="!allowUpdate || !choiceFlag"><i
                                                class="fa fa-plus">新增选项</i></button>
                                    </div>
                                </div>

                                <div class="form-group col-xs-11 col-md-12">
                                    <div>
                                        <table class="table table-bordered table-hover table-condensed">
                                            <thead class="bg-gray-white">
                                            <tr class="text-center">
                                                <th>序号</th>
                                                <th>选项内容</th>
                                                <th>是否题目答案</th>
                                                <th>是否显示</th>
                                                <th ng-if="current.projectType=='single_selection_skip'">跳转到</th>
                                                <th ng-if="current.projectType=='single_selection_show'">显示题目</th>
                                                <th>删除</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="item in qnChoiceData">
                                                <td>
                                                    <div style="margin-top: 16px;">{{$index+1}}</div>
                                                </td>
                                                <td style="width:250px;"><textarea class="form-control radius3" rows="2"
                                                                                   style="height:100%;width: 250px"
                                                                                   ng-model="item.qnChoiceContent"
                                                                                   ng-readonly="!allowUpdate || !choiceFlag"></textarea>
                                                </td>
                                                <td><input style="margin-top: 20px;" type="checkbox"
                                                           ng-false-value="'N'" ng-true-value="'Y'"
                                                           ng-model="item.qnAnswer"
                                                           ng-disabled="!allowUpdate || !choiceFlag"></td>
                                                <td><input style="margin-top: 20px;" type="checkbox"
                                                           ng-false-value="'N'" ng-true-value="'Y'"
                                                           ng-model="item.displayFlag"
                                                           ng-disabled="!allowUpdate || !choiceFlag"></td>
                                                <td ng-if="current.projectType=='single_selection_skip'">
                                                    <!--<div class="input-group" style="margin-top: 13px;">-->
                                                    <!--<input type="text" class="form-control" style="padding: 2px;height: 26px;" readonly>-->
                                                    <!--<span class="input-group-btn">-->
                                                    <!--<button class="btn btn-default btn-small"  style="padding:2px 10px;" type="button" ng-click="selectSingleProject()">选择题目</button>-->
                                                    <!--</span>-->
                                                    <!--</div>-->
                                                    <button class="btn btn-default btn-small"  style="margin-top: 13px;padding:2px 10px;" type="button" ng-click="selectSingleProject(item,$index)">选择题目</button>
                                                </td>
                                                <td ng-if="current.projectType=='single_selection_show'">
                                                    <button style="margin-top: 13px;padding:2px 10px;" class="btn btn-default btn-small" type="button" ng-click="selectMultiProject(item,$index)">选择题目</button>
                                                </td>
                                                <td>
                                                    <button style="margin-top: 13px;padding:2px 10px;" type="button"
                                                            class="btn btn-small btn-default"
                                                            ng-click="deleteChoice($index)"
                                                            ng-disabled="!allowUpdate || !choiceFlag">删除
                                                    </button>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer ">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal"
                                    ng-show="allowUpdate">取消
                            </button>
                            <button type="submit" id="saveButton" class="btn btn-primary mr10" ng-show="allowUpdate">
                                保存
                            </button>
                            <button type="button" class="btn btn-primary mr10" data-dismiss="modal"
                                    ng-show="!allowUpdate">返回
                            </button>
                        </div>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </form>
    </div>

</div>