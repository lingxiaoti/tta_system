<div ng-controller="ttaHwbCheckingCtrl" class="gridtable">
    <div data-des="此节点必需－用户计算滚动区域高度" main-scroll-style>
        <div class="nicescroll-height  bg-white" data-des="此节点必需-滚动内容及指令"
             nice-option="{cursorcolor: '#009E96',cursorwidth:10,zindex:10,autohidemode:false}">
            <!-- <div class="form bg-white" inner-frame data-des="此节点必需－内框页面的指令">-->
            <div class="col-xs-12 col-md-12 br p0">
                <ul class="nav nav-tabs" id="tab">
                    <li class="active" ng-click="tabChangeInfo('cWInfo')">
                        <a data-toggle="tab" ng-href="#cWInfo"><i class="fa fa-list-alt"></i>
                            <label>报表明细</label></a>
                    </li>

                    <!--                    <li ng-click="tabChangeInfo('cWSummary')">
                                            <a data-toggle="tab" href="#cWSummary"><i class="fa fa-list-alt"></i>
                                                <label>报表Summary</label></a>
                                        </li>-->
                </ul>
                <!-- Start tabContent -->
                <div class="tab-content" id="tabContent">
                    <!-- Start cWInfo -->
                    <div class="tab-pane fade in active col-md-12" id="cWInfo">
                        <!--------------------- 按钮--->
                        <div class="bg-gray-white p5">
                            <div class=" pull-right ml10">
                                <div class="btn-group btn-group-xs ml10" id="outputButton">
                                    <button class="btn btn-default" type="button" ng-click="search()">
                                        <i class="fa fa-search" aria-hidden="true"></i>{{$l('搜索')}}
                                    </button>
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnBz()" ></button>
                                    <!--
                                                                        <button type="button" class="btn btn-default" permission-btn=""  ng-click="submitApproval(cWReportForm)" ></button>
                                    -->
                                    <button type="button" class="btn btn-default"   permission-btn="" ng-click="btnSaveChecked('checked')" ></button>
                                    <button type="button" class="btn btn-default"   permission-btn="" ng-click="btnSaveCur('all')" ></button>
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnSd()" ></button>
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnWcqk()" ></button>
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnCreate(cWReportForm)" ></button>
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnExportTemplate()" ></button>
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnExportIn()" ></button>
                                    <button type="button" ng-click="windowSplit()" class="btn btn-default btn-xs">
                                        <i class="fa fa-pencil">拆分</i>
                                    </button>
                                    <!--<button type="button" class="btn btn-default ng-scope ng-binding" ng-click="CGPLHF()" style="">
                                        <i class="fa fa-reply-all"></i> 采购批量回复
                                    </button>-->
                                    <button type="button" class="btn btn-default" permission-btn=""  ng-click="CGPLHF()" ></button>
                                </div>
                                <div class="btn-group btn-group-xs "  permission-buttons="btnExport" data-disabled-for-table="dataTable"></div>
                            </div>
                            <div class="btn-group btn-group-xs ">
                                <button class="btn btn-primary" ng-click="fullWindow($event)"><i class="fa fa-square-o"></i>数据全屏
                                </button>
                            </div>
                        </div>
                        <!---------------------  / .按钮  --->
                        <div main-scroll-style data-des="此节点必需－用户计算滚动区域高度">
                            <div class="nicescroll-height  bg-white "
                                 nice-option="{{niceOpction}}" data-des="此节点必需-滚动内容及指令">
                                <div class="col-xs-12 col-md-12" style="margin-right: -1px; height: 100%; ">



                                    <form class="  m10" ng-submit="cWTable.getData()">

                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w120">促销区间：</span></label>
                                                <input  type="text" ng-model="params.promotionSection"
                                                        class="form-control radius3">

                                            </div>
                                        </div>

                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">供应商编号：</span></label>
                                                <input  type="text" ng-model="params.priorVendorCode"
                                                        class="form-control radius3">

                                            </div>
                                        </div>
                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">供应商名称：</span></label>
                                                <input  type="text" ng-model="params.priorVendorName"
                                                        class="form-control radius3">

                                            </div>
                                        </div>

                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">产品编号：</span></label>
                                                <input  type="text" ng-model="params.itemCode"
                                                        class="form-control radius3">

                                            </div>
                                        </div>
                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">BRAND_CN：</span></label>
                                                <input  type="text" ng-model="params.brandCn"
                                                        class="form-control radius3">

                                            </div>
                                        </div>
                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">GROUP_DESC：</span></label>
                                                <input  type="text" ng-model="params.groupDesc"
                                                        class="form-control radius3">

                                            </div>
                                        </div>
                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn">
                                                    <span class="w100">部门：</span></label>
                                                <input class="form-control radius3" ng-model="params.deptCode"
                                                       type="text" readonly>
                                                <span class="input-group-btn ng-scope">
                                                <button class="btn btn-default"  ng-click="paramsCancel()"
                                                        type="button"><i class="fa fa-remove"></i></button>
                                                <button class="btn btn-default" ng-click="getDeptCode()"
                                                        type="button">
                                                        <i class="fa fa-search"></i>
                                                </button>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">HWB_TYPE：</span></label>
                                                <select class     ="form-control radius3"
                                                        ng-model  ="params.hwbType">
                                                    <option value ="">请选择</option>
                                                    <option value ="席位费">席位费</option>
                                                    <option value ="Award">Award</option>
                                                </select>

                                            </div>
                                        </div>
                                        <div class="form-group col-xs-6 col-md-4 col-lg-3">
                                            <div class="input-group input-group-xs">
                                                <label class="input-group-addon bn"><span
                                                        class="w100">单据状态：</span></label>
                                                <div lookup-code="TTA_OI_STATUS" name="processStatus" ng-model="params.processStatus" ></div>
                                            </div>
                                        </div>
                                        <div class="row"></div>


                                    </form>
                                    <form id="cWReportForm" name="cWReportForm">
                                        <div  id ="parentFixedId" style="" main-scroll-style>
                                            <div id ="fixedId" style ="  height: auto;overflow:auto;position:relative" class="data-table"  id="nicescroll_tta_oi_cw" nice-option="{oneaxismousemode:true,railvalign: 'bottom',cursorcolor:'#1e90c2',cursorwidth:'10px',autohidemode:false,zindex:10}" >
                                                <table saaf-table="cWTable"
                                                       id = "cwTableId"
                                                       data-url="findTtaHwbMajorPagination"
                                                       data-after-get-data="afterGetData()"
                                                       data-params="params"
                                                       data-checked-type="radio"
                                                       data-auto-get-data="true"
                                                       data-page-rows="100"
                                                       class=" nicescroll-height  table table-bordered table-hover table-condensed">
                                                    <thead class="bg-gray-white">
                                                    <tr class="text-center">
                                                        <th>
                                                            <input  ng-checked="selectedAll" type="checkbox"
                                                                    ng-click="checkedAll($event)" >
                                                        </th>
                                                        <th>序号</th>
                                                        <th>批次编号</th>
                                                        <th>流程单据号</th>
                                                        <th>流程状态</th>
                                                        <th>促销期间</th>
                                                        <th>Award Description（CN）</th>
                                                        <th>Award Description on DM & POP（CN）</th>
                                                        <th>促销开始日期</th>
                                                        <th>促销结束日期</th>
                                                        <th>HWB_TYPE</th>
                                                        <th>GROUP_DESC</th>
                                                        <th>DEPT_CODE</th>
                                                        <th>DEPT_DESC</th>
                                                        <th>品牌</th>
                                                        <th>活动内容</th>
                                                        <th>采购确认供应商编码</th>
                                                        <th>采购确认供应商名称</th>
                                                        <th>公司标准</th>
                                                        <th>协定标准</th>
                                                        <th>数量</th>
                                                        <th>收费标准</th>
                                                        <th>应收金额(不含加成)</th>
                                                        <th>应收金额(含加成)</th>
                                                        <th>调整实收金额</th>
                                                        <th>调整人</th>
                                                        <th>TTA/OnTop</th>
                                                        <th>采购确认收取金额(不含加成)</th>
                                                        <th>采购确认收取金额(含加成)</th>
                                                        <th>差异(含加成)</th>
                                                        <th>供应商编码</th>
                                                        <th>供应商名称</th>
                                                        <th><div style="width: 170px;">文件操作</div></th>
                                                        <th>采购行动</th>
                                                        <th>豁免原因_1</th>
                                                        <th>豁免原因_2</th>
                                                        <th>借记单编号</th>
                                                        <th>实收金额</th>
                                                        <th>备注</th>
                                                        <th>提交人</th>
                                                        <th>当前审批人</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody ng-show="cWTable.data">
                                                    <tr class="text-center" ng-repeat="row in cWTable.data"
                                                        ng-class="{'active':cWTable.data.selectRow==$index}"
                                                        ng-click="cWTable.data.selectRow=$index;
                                                         cWTable.data.selectRowData =row;" >
                                                        <td>
                                                            <input id="{{  'cWTable_'+row.hwbId}}" ng-checked="row.checked" type="checkbox"
                                                                   ng-click="check(row,$event)" name="keys" ng-disabled="row.processStatus &&  row.processStatus!='DS01'">
                                                        </td>
                                                        <td ng-bind="$index+1" class="w50">1</td>
                                                        <td><span>{{row.batchCode}}</span></td>
                                                        <td><a href="javascript:" ng-click="getRow(row)">{{row.processCode}}</a></td>
                                                        <td>{{row.processStatusName}}</td>
                                                        <td><span>{{row.promotionSection}}</span></td>
                                                        <td><span>{{row.descriptionCn}}</span></td>
                                                        <td><span>{{row.awardDescription}}</span></td>
                                                        <td><span>{{row.promotionStartDate}}</span></td>
                                                        <td><span>{{row.promotionEndDate}}</span></td>
                                                        <td><span>{{row.hwbType}}</span></td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.deptDesc}}</span>
                                                            <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'groupDesc' + $index}}"
                                                                       ng-model="row.groupDesc">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.deptCode}}</span>
                                                            <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'deptCode' + $index}}"
                                                                       ng-model="row.deptCode">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.deptDesc}}</span>
                                                            <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'deptDesc' + $index}}"
                                                                       ng-model="row.deptDesc">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.brandCn}}</span>
                                                            <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'brandCn' + $index}}" ng-change="changeHwbBrand(row)"
                                                                       ng-model="row.brandCn">
                                                            </div>

                                                        </td>
                                                        <td>
                                                            <div class="input-group input-group-xs"   style="width: 400px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs" ng-required="row.checked" name = "{{'content' + $index}}"
                                                                       ng-model="row.content">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="input-group input-group-xs"   style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control radius3" ng-model="row.priorVendorCode" name="{{'priorVendorCode'+$index}}"
                                                                       readonly  type="text" ng-required="row.checked" style="width: 85px;"/>
                                                                <span class="input-group-btn ng-scope">
                                                                    <button ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="btn btn-default"  ng-click="clearVendor()"
                                                                            type="button"><i class="fa fa-remove"></i></button>
                                                                    <button ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="btn btn-default" ng-click="getVendorRow()" type="button">
                                                                        <i class="fa fa-search"></i>
                                                                    </button>
                                                                </span>
                                                            </div>
                                                        </td>
                                                        <td><span>{{row.priorVendorName}}</span></td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.companyStandard}}</span>
                                                            <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'companyStandard' + $index}}" to-change-number
                                                                       ng-model="row.companyStandard">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.agreementStandard}}</span>
                                                            <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'agreementStandard' + $index}}" to-change-number
                                                                       ng-model="row.agreementStandard">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span >{{row.num}}</span>

                                                        </td>
                                                        <td>
                                                            <div class="input-group input-group-xs"
                                                                 style="width: 100px;">
                                                                <select ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class     ="form-control radius3" ng-if="row.hwbType=='Award'"
                                                                        ng-change ="TermsChangeIn(row,row.incomeTypeList,row.incomeType)"
                                                                        ng-model  ="row.chargeStandards"  ng-required="row.checked" name ="{{'chargeStandards' + $index}}">
                                                                    <option value ="公司标准">公司标准</option>
                                                                    <option value ="协定标准">协定标准</option>
                                                                </select>
                                                                <select ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class     ="form-control radius3" ng-if="row.hwbType=='席位费'"
                                                                        ng-change ="TermsChangeIn(row,row.incomeTypeList,row.incomeType)"
                                                                        ng-model  ="row.chargeStandards"  ng-required="row.checked" name ="{{'chargeStandards' + $index}}">
                                                                    <option value ="Normal">Normal</option>
                                                                    <option value ="VIP">VIP</option>
                                                                </select>
                                                            </div>
                                                        </td>
                                                        <td><span>{{row.noReceiveAmount | number:0}}</span></td>
                                                        <td><span>{{row.receiveAmount | number:0}}</span></td>
                                                        <td>
                                                            <div class="input-group input-group-xs"   style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"  name = "{{'adjustAmount' + $index}}"
                                                                       ng-model="row.adjustAmount">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="input-group input-group-xs"   style="width: 100px;">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control radius3" ng-model="row.adjustByName" name="{{'adjustByName'+$index}}"
                                                                       readonly  type="text"/>
                                                                <span class="input-group-btn ng-scope">
                                                                    <button ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="btn btn-default" ng-click="getNameL()" type="button">
                                                                        <i class="fa fa-search"></i>
                                                                    </button>
                                                                </span>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="input-group input-group-xs" style="width: 84px;">
                                                                <div lookup-code="TTA_COLLECTION_METHOD"
                                                                     data-first-text="请选择"
                                                                     data-paramcallback="collectFun"
                                                                     data-row="{{cWTable.data.indexOf(row)}}"
                                                                     ng-model="row.collect"
                                                                     name ="{{'collect' + $index}}"
                                                                     ng-required="row.checked"
                                                                     ng-disabled="row.processStatus &&  row.processStatus!='DS01'"
                                                                ></div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <!--<span>{{row.unconfirmAmount}}</span>-->
                                                            <div class="input-group input-group-xs" style="width: 172px;" >
                                                                <span ng-show="false">第{{$index +1}}行【采购确认收取金额(不含加成)】必须为整数</span>
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs" ng-required="row.checked"
                                                                       ng-model="row.noUnconfirmAmount" to-change-number name="{{'noUnconfirmAmount' + $index}}"
                                                                       ng-change="countDifferenceAmt(row)"
                                                                       ng-blur="blurEvent(row)"
                                                                       placeholder="请输入整数" title="请输入整数" ng-pattern="/^\d+$/"
                                                                >
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <!--<span>{{row.unconfirmAmount}}</span>-->
                                                            <!--ng-disabled="row.processStatus &&  row.processStatus!='DS01'"-->
                                                            <!--ng-value="row.unconfirmAmount = (row.collect == 'TTA' ? (row.noUnconfirmAmount * (100+ (row.additionRate?row.additionRate:0) *1)/100).toFixed(0) : row.noUnconfirmAmount )"-->
                                                            <div class="input-group input-group-xs" style="width: 172px;" >
                                                                <input class="form-control input-xs" ng-disabled="true"
                                                                       ng-model="row.unconfirmAmount" to-change-number name="{{'unconfirmAmount' + $index}}"
                                                                       >

                                                            </div>
                                                        </td>
                                                        <td> <div style="width: 150px">
                                                            <!--<span>{{row.difference}}</span>-->
                                                            <!--ng-value="row.difference = ((row.unconfirmAmount*1-row.receiveAmount*1)<0 ? (row.unconfirmAmount*1-row.receiveAmount*1).toFixed(0) : 0 )"-->
                                                            <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"
                                                                   ng-model="row.difference" to-change-number name="{{'difference' + $index}}" disabled
                                                            >
                                                        </div>
                                                        </td>
                                                        <td><span>{{row.parentVendorCode}}</span></td>
                                                        <td><span>{{row.parentVendorName}}</span></td>

                                                        <td>
                                                            <!--<button type="button"  ng-click="uploadFile()" class="btn btn-primary btn-xs"  id="addRelSupplierButton"><i class="fa fa-plus">上传附件</i></button>-->
                                                            <a  type="button" ng-click="fileInfoFunc(row)" style="cursor:pointer;white-space:nowrap">文件详情</a>
                                                        </td>
                                                        <td>
                                                        <div class="input-group input-group-xs" style="width: 172px;">
                                                            <!--<div lookup-code="TTA_CW_ACTION" data-first-text="请选择"  data-callback="purchaseFun"    ng-model="row.purchase" required></div>-->
                                                            <div class="input-group input-group-xs">
                                                                <div lookup-code="TTA_HWB_ACTION"
                                                                     ng-required="row.checked" name="{{'purchase'+$index}}"
                                                                     data-first-text="请选择"
                                                                     data-paramcallback="purchaseFun"
                                                                     data-row="{{cWTable.data.indexOf(row)}}"
                                                                     ng-model="row.purchase"
                                                                     ng-disabled="row.processStatus &&  row.processStatus!='DS01'"
                                                                ></div>
                                                            </div>
                                                        </div>

                                                        </td>

                                                        <td>
                                                            <div class="input-group input-group-xs" style="width: 172px;">
                                                                <!--
                                                                                                        <div lookup-code="TTA_CW_REASON" data-first-text="请选择"    ng-model="row.exemptionReason" required></div>
                                                                -->
                                                                <select ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class     ="form-control radius3"
                                                                        ng-change ="exemptionReasonListChangeIn(row,row.exemptionReasonList,row.exemptionReason)"
                                                                        ng-required="row.exemptionReasonList && row.exemptionReasonList.length>0 && row.checked"
                                                                        name="{{'exemptionReason'+$index}}"
                                                                        ng-model  ="row.exemptionReason">
                                                                    <option value ="">{{firstText}}</option>
                                                                    <option ng-bind="iterm.meaning"
                                                                            ng-repeat="iterm in row.exemptionReasonList"
                                                                            value="{{iterm.lookupCode}}"></option>
                                                                </select>
                                                            </div>
                                                        </td>
                                                        <td title="{{row.exemptionReason2}}">
                                                            <div class="input-group input-group-xs" style="width: 172px;">
                                                                <!--<div lookup-code="TTA_CW_REASON1" data-first-text="请选择"    ng-model="row.exemptionReason2" required></div>-->
                                                                <select ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class     ="form-control radius3"
                                                                        ng-required="row.exemptionReasonList2 && row.exemptionReasonList2.length>0 && row.checked"
                                                                        name="{{'exemptionReason2'+$index}}"
                                                                        ng-model  ="row.exemptionReason2">
                                                                    <option value ="">{{firstText}}</option>
                                                                    <option ng-bind="iterm.meaning"
                                                                            ng-repeat="iterm in row.exemptionReasonList2"
                                                                            value="{{iterm.lookupCode}}"></option>
                                                                </select>
                                                            </div>
                                                        </td>

                                                        <td>
                                                            <div class="input-group input-group-xs" style="width: 172px;" >
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs" ng-required="row.purchase=='A02' && row.checked"
                                                                       ng-model="row.debitOrderCode">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span ng-if="!(userType == '45')">{{row.receipts}}</span>
                                                            <div class="input-group input-group-xs" style="width: 172px;" ng-if="userType == '45'">
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01'" class="form-control input-xs"
                                                                       ng-model="row.receipts">
                                                            </div>
                                                        </td>
                                                        <td><!--备注-->
                                                            <div class="input-group input-group-xs" style="width: 172px;" >
                                                                <!--ng-required="row.purchase=='A01' && row.difference <0 &&  row.checked"-->
                                                                <input ng-disabled="row.processStatus &&  row.processStatus!='DS01' && !(userType == '45')" class="form-control input-xs"
                                                                       ng-model="row.remark" name="{{'remark' + $index}}">
                                                            </div>
                                                        </td>
                                                        <td><span>{{row.startUserName}}</span></td>
                                                        <td><span>{{row.currentUserName}}</span></td>
                                                        <!--                                    <td>-->
                                                        <!--                                        <div class="input-group input-group-xs">-->
                                                        <!--                                            <div lookup-code="BASE_USER_DT" data-first-text="请选择类型"    ng-model="row.dataType"></div>-->
                                                        <!--                                        </div>-->
                                                        <!--                                    </td>-->
                                                        <!--<td><a href="javascript:" ng-click="usersAuthorityParams2.userId = row.userId;usersAuthorityTable2.getData()">点我</a></td>-->
                                                    </tr>
                                                    </tbody>
                                                </table>


                                            </div>
                                            <div saaf-table-tfoot="cWTable" ng-show="cWTable.data.length>0"></div>
                                        </div>
                                    </form>

                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- End cWInfo -->

                    <!-- Start Summary 开始-->

                    <!-- End Summary 结束-->

                </div>
                <!-- End tabContent -->
            </div>
        </div>
    </div>

    <div class="modal fade" id="addFileUpload" data-des="文件上传" data-backdrop="static" tabindex="-1" style="z-index: 1065;">
        <div class="modal-dialog " style="width: 600px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        文件上传
                    </h4>
                </div>
                <form class="ngValid" name="funcMenucWForm"  >
                    <div class="modal-body">
                        <div class="form-group col-xs-12 col-md-12">
                            <div class="btn-group btn-group-xs" style="">
                                <input  type="file" id ="cWReportUploadFile" name="cWReportUploadFile"  emms-file-upload="myFile">
                            </div>
                        </div>
                        <div class="cb"></div>
                    </div>

                    <div class="modal-footer ">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="uploadFile(funcMenucWForm.$invalid)" validate-form-btn="" data-validate-form="funcMenucWForm" id="saveButton" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div lov-list="userGroupDeptBrandLovList" role="dialog" data-title="用户" id="userGroupDeptBrandLov" ng-model="code1" class="  "
         data-url="itemFind"
         data-params="{findFlag:'userGroupDeptBrand'}"
         data-callback="selecGroupReturn"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="checkbox"
         data-keys="{'key':'valueAll','value':'groupCode',name:'GROUP'}"
         data-show-index="false"
         data-other-column="[
            {'name':'GROUP_DESC','key':'groupDesc'},
            {'name':'DEPT','key':'deptCode'},
            {'name':'DEPT_DESC','key':'deptDesc'},
             {'name':'BRAND_CN','key':'brandCn'},
            {'name':'BRAND_EN','key':'brandEn'},
             {'name':'BRAND_CODE','key':'brandCode'}
        ]"
         data-search-key="[
         {'key':'groupCode','placeholder':'GROUP'},
         {'key':'deptCode','placeholder':'DEPT'},
         {'key':'brandCode','placeholder':'BRAND'},
         ]"
    >
    </div>

    <div data-auto-request="true" data-callback="selectdjustByReturn" data-checked-type="radio"
         data-other-column="[{key:'userName',name:'账号'},{key:'userFullName',name:'员工姓名'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'userFullName','placeholder':'请输入员工姓名'},{'key':'userName','placeholder':'请输入员工账号'}]"
         data-show-index="false"
         data-title="选择调整人"
         data-type="competitor"
         data-keys="{'key':'userName','value':'userFullName','name':'账号',hide:'true'}"
         data-url="processFindInternalUsers"
         id="lovHwbReportAdjustByFind"
         lov-list="lovHwbReportFindMan2"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <div lov-list="userGroupLovList" role="dialog" data-title="用户" id="userGroupLov" ng-model="code1" class="  "
         data-url="itemFind"
         data-params="{findFlag:'findGroup'}"
         data-callback="selecGroupReturn"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="checkbox"
         data-keys="{'key':'groupCode','value':'groupCode',name:'GROUP'}"
         data-show-index="false"
         data-other-column="[
            {'name':'GROUP_DESC','key':'groupDesc'}
        ]"
         data-search-key="[
         {'key':'groupCode','placeholder':'GROUP'},
         {'key':'groupDesc','placeholder':'GROUP_DESC'}
         ]"
    >
    </div>

    <div data-auto-request="true" data-callback="selectDeptFeeAReturn" data-checked-type="checkbox"
         data-dynamic-params='{"flag": "findDept","departmentType":"40","parentDepartmentId":""}'
         data-keys="{'key':'departmentCode','value':'departmentCode','name':'部门编码'}"
         data-other-column="[{'name':'部门名称','key':'departmentName'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'departmentCode','placeholder':'部门编码'},
	                       {'key':'departmentName','placeholder':'部门名称'}]"
         data-show-index="false"
         data-title="选择部门信息"
         data-type="competitor"
         data-url="findDeptPagination"
         id="ttaHwbDeptCodeId"
         lov-list="ttaHwbDeptCodeLov"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <div class="modal fade" id="excelUp2" data-des="EXCEL_UP" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="fileImportId">
                        文件
                    </h4>
                </div>

                <div style="text-align:right;margin:0px auto 0px auto">
                    <div class="btn-group btn-group-xs ml5 ">
                        <button type="button" ng-disabled="ttaHwbfileDataTable.selectRow == undefined"   ng-click="delUploadFile()" class="btn btn-default btn-xs"  id="del"> <i class="fa fa-trash">删除</i></button>
                        <button type="button"  ng-click="callback(cWTable.data.selectRowData,cWTable.data.selectRow,'upload')" class="btn btn-primary btn-xs"  id="saveFile"><i class="fa fa-plus">上传附件</i></button>
                    </div>
                </div>
                <div class="data-table">
                    <div base-data-table="ttaHwbfileDataTable" id = "ttaHwbfileDataTableId"
                         ng-params="fileDataParams"
                         data-keys="{'key':'functionId','value':'functionId','name':'模块id'}"
                         data-show-index="true"
                         data-auto-request="true"
                         data-url="findBaseAttachmentList"
                         data-legend="[
                                                                     {'value':'createdByUser','name':'上传人'},
                                                                     {'value':'creationDate','name':'上传时间'},
                                                                     {'value':'sourceFileName','name':'上传附件名称'},
                                                                 ]"
                         data-func-column = "[{'icon':'fa fa-download','text':'下载附件','callback':'downFileEvent'}]"

                    >
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div lov-list="userGroupDeptBrandLovList" role="dialog" data-title="用户" id="userGroupDeptLov" ng-model="code1" class="  "
         data-url="itemFind"
         data-params="{findFlag:'findGroupDept'}"
         data-callback="selecGroupReturn"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="checkbox"
         data-keys="{'key':'valueAll','value':'groupCode',name:'GROUP'}"
         data-show-index="false"
         data-other-column="[
            {'name':'GROUP_DESC','key':'groupDesc'},
            {'name':'DEPT','key':'deptCode'},
            {'name':'DEPT_DESC','key':'deptDesc'}
        ]"
         data-search-key="[
         {'key':'groupCode','placeholder':'GROUP'},
         {'key':'deptCode','placeholder':'DEPT'},
         ]"
    >
    </div>

    <div class="modal fade" id="cwSplit" data-des="拆分" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog " style="width: 700px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        请填写
                    </h4>
                </div>
                <form class="ngValid" name="funcMenuForm"  >
                    <div>
                        <label style="margin-left: 10px"><i class="fa fa-list-alt"></i>详情</label>
                        <div  class="btn-group btn-group-xs ml5 pull-right">
                            <button type="button" class="btn btn-default btn-xs " ng-disabled="splitDataTable.selectRow==undefined" ng-click="btnDelRow()"><i class="fa fa-trash-o fa-lg"></i>删除</button>
                            <button type="button" class="btn btn-default btn-xs" ng-click="btnNewRow()"><i class="fa fa-plus">增加</i></button>
                        </div>

                    </div>


                    <div class="data-table">
                        <table
                                class="table table-bordered table-hover table-condensed">
                            <thead class="bg-gray-white">
                            <tr class="text-center">
                                <th>采购确认收取金额(不含加成)</th>
                                <th style="min-width: 200px">供应商</th>
                                <th>供应商名称</th>
                                <th>加成比例</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="text-center" ng-repeat="row in splitDataTable"
                                ng-class="{'active':splitDataTable.selectRow==$index}"
                                ng-click="splitDataTable.selectRow=$index">
                                <td>
                                    <div class="input-group input-group-xs">
                                        <input class="form-control radius3" ng-model="row.noUnconfirmAmount" name="{{'noUnconfirmAmountsplit'+$index}}"
                                               required type="text"  to-change-number />
                                    </div>
                                </td>
                                <td>
                                    <div class="input-group input-group-xs">
                                    </div>
                                    <div class="input-group input-group-xs">
                                        <input class="form-control radius3" ng-model="row.priorVendorCode" name="{{'priorVendorCode_split'+$index}}"
                                               readonly required type="text"/>
                                        <span class="input-group-btn ng-scope">
                                        <button class="btn btn-default" ng-click="getVendorL()" type="button">
                                            <i class="fa fa-search"></i>
                                        </button>
                                    </span>
                                    </div>
                                </td>
                                <td>
                                    <span>{{row.priorVendorName}}</span>
                                </td>
                                <td>
                                    <span>{{row.additionRate}}</span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="modal-footer " ng-if="buttonFlag">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="saveWindow(funcMenuForm.$invalid)" validate-form-btn="" data-validate-form="funcMenuForm" id="saveButton" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div data-auto-request="true" data-callback="selectSupplierReturn" data-checked-type="radio"
         data-dynamic-params="{flag:'isAdditionRate'}" data-keys="{'key':'supplierCode','value':'supplierCode','name':'供应商编码'}"
         data-other-column="[{'name':'供应商名称','key':'supplierName'},{'name':'加成比例','key':'additionRate'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'supplierCode','placeholder':'供应商编码'},
                          {'key':'supplierName','placeholder':'供应商名称'}]"
         data-show-index="false"
         data-title="选择供应商信息"
         data-type="competitor"
         data-url="supplierFindLov"
         id="cWReportListId"
         lov-list="cWReportList"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <div data-auto-request="true" data-callback="selectTransferReturn" data-checked-type="radio"
         data-other-column="[{key:'userName',name:'账号'},{key:'userFullName',name:'员工姓名'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'userFullName','placeholder':'请输入员工姓名'},{'key':'userName','placeholder':'请输入员工账号'}]"
         data-show-index="false"
         data-title="选择转办人"
         data-type="competitor"
         data-keys="{'key':'userName','value':'userFullName','name':'账号',hide:'true'}"
         data-url="processFindInternalUsers"
         id="lovcWReportFind"
         lov-list="lovcWReportFind"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <div data-auto-request="true" data-callback="selectReportExportCwReturn" data-checked-type="checkbox"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'batchId','placeholder':'请输入批次号'}]"
         data-show-index="false"
         data-title="选择导出条件"
         data-params = "{'reportType':'CW'}"
         data-type="competitor"
         data-keys="{'key':'batchId','value':'batchId','name':'批次号',hide:'true'}"
         data-url="reportHeaderFind"
         id="findReportExportCwId"
         lov-list="findReportExportCwList"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <div data-auto-request="true" data-callback="selectSupplierLineReturn" data-checked-type="radio"
         data-dynamic-params="{flag:'isAdditionRate'}" data-keys="{'key':'supplierCode','value':'supplierCode','name':'供应商编码'}"
         data-other-column="[{'name':'供应商名称','key':'supplierName'},{'name':'加成比例','key':'additionRate'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'supplierCode','placeholder':'供应商编码'},
                          {'key':'supplierName','placeholder':'供应商名称'}]"
         data-show-index="false"
         data-title="选择供应商信息"
         data-type="competitor"
         data-url="supplierFindLov"
         id="cWReportLineId"
         lov-list="cWReportLineList"
         ng-model="current.em"
         role="dialog"
    >
    </div>


    <div class="data-table" ng-show="false">
        <div base-data-table="dataTable"
             ng-params="params"
             data-show-index="true"
             data-url="findTtaHwbMajorPagination"
             data-keys="{key:'hwbId'}"
             data-legend="[
                                     {'value':'hwbId','name':'唯一标识'},
                                     {'value':'batchCode','name':'批次编号'},
                                     {'value':'processCode','name':'流程单据号'},
                                     {'value':'processStatusName','name':'流程状态'},
                                    {'value':'promotionSection','name':'促销区间'},
                                    {'value':'descriptionCn','name':'Award Description（CN）'},
                                    {'value':'awardDescription','name':'Award Description on DM & POP（CN）'},
                                    {'value':'promotionStartDate','name':'促销开始日期'},
                                    {'value':'promotionEndDate','name':'促销结束日期'},
                                    {'value':'hwbType','name':'HWB_TYPE'},
                                    {'value':'groupDesc','name':'GROUP_DESC'},
                                    {'value':'deptCode','name':'DEPT_CODE'},
                                    {'value':'deptDesc','name':'DEPT_DESC'},
                                    {'value':'brandCn','name':'品牌'},
                                    {'value':'content','name':'活动内容'},
                                    {'value':'priorVendorCode','name':'采购确认供应商编码'},
                                    {'value':'priorVendorName','name':'采购确认供应商名称'},
                                    {'value':'companyStandard','name':'公司标准'},
                                    {'value':'agreementStandard','name':'协定标准'},
                                    {'value':'num','name':'数量'},
                                    {'value':'chargeStandards','name':'收费标准'},
                                    {'value':'noReceiveAmount','name':'应收金额(不含加成)'},
                                    {'value':'receiveAmount','name':'应收金额(含加成)'},
                                    {'value':'adjustAmount','name':'调整实收金额'},
                                    {'value':'adjustByName','name':'调整人'},
                                    {'value':'collect','name':'TTA/OnTop'},
                                    {'value':'noUnconfirmAmount','name':'需采购确认收取金额(不含加成)'},
                                    {'value':'unconfirmAmount','name':'需采购确认收取金额(含加成)'},
                                    {'value':'difference','name':'差异(含加成)'},
                                    {'value':'parentVendorCode','name':'供应商编码'},
                                    {'value':'parentVendorName','name':'供应商名称'},
                                    {'value':'purchaseName','name':'采购行动'},
                                    {'value':'exemptionReasonName','name':'豁免原因_1'},
                                    {'value':'exemptionReason2Name','name':'豁免原因_2'},
                                    {'value':'debitOrderCode','name':'借记单编号'},
                                    {'value':'receipts','name':'实收金额'},
                                    {'value':'remark','name':'备注'},
                                    {'value':'startUserName','name':'提交人'},
                                     {'value':'currentUserName','name':'当前审批人'}
                             ]"
        ></div>
    </div>

    <!--excel 上传 并更新借记编号，实收金额start -->
    <div class="modal fade" id="excelUp" data-des="EXCEL_UP" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="fileImportId">
                        导入
                    </h4>
                </div>
                <form class="ngValid" name="funcUpForm"  >
                    <div class="modal-body">
                        <div class="form-group col-xs-12 col-md-12">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn">
                                    <span class="w100">选择文件</span></label>
                                <input type="file" required accept="*.xlsx"  id="fileUpLoad">
                            </div>
                        </div>
                        <div class="cb"></div>
                    </div>

                    <div class="modal-footer ">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="uploadSave(funcMenuForm.$invalid)" validate-form-btn="" data-validate-form="funcUpForm" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>



    <!--采购批量回复-->
    <form id="nppPurchaseReplyForm" name="nppPurchaseReplyForm" ng-submit="saveNppPurchaseReply(nppPurchaseReplyForm)">
        <div class="modal fade" id="nppPurchaseReplyModal" data-backdrop="static" data-keyboard="false" tabindex="-1"
             role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog " style="margin-top: 30px">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"
                                aria-hidden="true">&times;
                        </button>
                        <h4 class="modal-title" id="purchaseReplyTitle">
                            采购批量回复
                        </h4>
                    </div>
                    <div class="w80p h20" style=""></div>
                    <div class="modal-body ">
                        <div class="pl30 pr30">
                            <div class="row">
                                <div class="form-group col col-xs-11 col-md-6" >
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100"><i class="red">*</i>采购行动：</span></label>
                                        <div lookup-code="TTA_HWB_ACTION"
                                             required
                                             name="purchaseActReply"
                                             data-first-text="请选择"
                                             data-callback="purchaseReplyFun"
                                             ng-model="currentPurcahseReply.purchaseAct">
                                        </div>

                                    </div>
                                </div>

                                <div class="form-group col col-xs-11 col-md-6" >
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100"><i class="red">*</i>豁免原因_1：</span></label>
                                        <select class="form-control radius3"
                                                name="exemptionReasonReply"
                                                ng-change ="exemptionReasonListChangeByModal()"
                                                ng-model  ="currentPurcahseReply.exemptionReason">
                                            <option value ="">{{firstText}}</option>
                                            <option ng-bind="iterm.meaning"
                                                    ng-repeat="iterm in currentExemptionReasonList"
                                                    value="{{iterm.lookupCode}}"></option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group col col-xs-11 col-md-6" >
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span class="w100">豁免原因_2：</span></label>
                                        <select class="form-control radius3"
                                                name="exemptionReason2Reply"
                                                ng-model="currentPurcahseReply.exemptionReason2">
                                            <option value ="">{{firstText}}</option>
                                            <option ng-bind="iterm.meaning"
                                                    ng-repeat="iterm in currentExemptionReasonList2"
                                                    value="{{iterm.lookupCode}}"></option>
                                        </select>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="margin-top: 20px;">
                        <div style="text-align: center">
                            <button style="" type="button" class="btn btn-default btn-sm" data-dismiss="modal">取消</button>

                            <button id="submitNppPurchaseReply"  type="submit" class="btn btn-primary btn-sm">
                                <span>保存</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>


</div>