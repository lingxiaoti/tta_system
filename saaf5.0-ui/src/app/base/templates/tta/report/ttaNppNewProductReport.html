<div ng-controller="ttaNppNewProductReportLineCtrl" class="bigdata">
    <form class="form bg-white" inner-frame data-des="此节点必需－内框页面的指令" >
        <div class="bg-gray-white bt">
            <div class="bg-gray-white p5">
                <div class=" pull-right ml10">
                    <div class="btn-group btn-group-xs ml10" id="outputButton">
                        <button class="btn btn-default" type="button" ng-click="search()">
                            <i class="fa fa-search" aria-hidden="true"></i>{{$l('搜索')}}
                        </button>
                        <button class="btn btn-default" type="button" ng-click="dataTable.restore()">
                            <i class="fa fa-undo" aria-hidden="true"></i>{{$l('重置')}}
                        </button>
                        <button type="button" class="btn btn-default" permission-btn=""  ng-click="CGPLHF()" ></button>
                        <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnBz()" ></button>
                       <!-- <button type="button" class="btn btn-default" permission-btn=""  ng-click="submitApproval(NPPReportForm)" ></button>-->
                        <button type="button" class="btn btn-default"   permission-btn="" ng-click="btnSaveChecked('checked')" ></button>
                        <button type="button" class="btn btn-default"   permission-btn="" ng-click="btnSaveCur('all')" ></button>
                        <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnCreate(NPPReportForm)" ></button>
                       <!-- <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnSd()" ></button>
                        <button type="button" class="btn btn-default" permission-btn=""  ng-click="btnWcqk()" ></button>-->
                        <button type="button" ng-click="nPPwindowSplit()" class="btn btn-default btn-xs">
                            <i class="fa fa-pencil">拆分</i>
                        </button>
                        <div class="btn-group btn-group-xs "  permission-buttons="btnExport" data-disabled-for-table="dataTable"></div>
                    </div>
                </div>

                <div class="btn-group btn-group-xs ">
                    <button type="button" class="btn btn-primary" ng-click="fullWindow($event)">
                        <i class="fa fa-square-o"></i>{{$l('数据全屏')}}
                    </button>
                </div>
            </div>
        </div>

        <div main-scroll-style data-des="此节点必需－用户计算滚动区域高度">
            <div class="nicescroll-height  bg-white "
                 nice-option="{{niceOpction}}" data-des="此节点必需-滚动内容及指令">
                <!--------------------- 输入表单  --->

                <div class=" mt10 pb5  oh"
                     data-des="此节点必需－用于识别输入表单的指令">
                    <form id="contractForm" name="contractForm" ng-submit="dataTable.getData()">
                        <header class="col-xs-12 mb10">
                            <i class="fa fa-cog" aria-hidden="true"></i>
                            <span>单据头信息</span>
                        </header>

                        <div class="form-group col-md-3 col-lg-3">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn"><span
                                        class="w100">供应商编号:</span></label>
                                <input  type="text" ng-model="params.vendorNbr"
                                        class="form-control radius3">
                            </div>
                        </div>

                        <div search-form
                             data-legend="[
                                                {key:'groupCode',label:'GROUP_CODE','type':'lov','target':'#groupLov'},
                                                {key:'groupDesc',label:'GROUP_DESC'},
                                                {key:'deptCode',label:'DEPT_CODE','type':'lov','target':'#deptLov'},
                                                {key:'deptDesc',label:'DEPT_DESC'},
                                                {key:'brandCn',label:'BRAND_CN','type':'lov','disabled':'false','target':'#brandLov'},
                                                {key:'itemCode',label:'产品编号','type':'lov','disabled':'false','target':'#itemLov'},
                                                {key:'collectWay',label:'收取方式',type:'lookCode',lookCode:'NEW_PAYMENT'},
                                                {key:'purchaseAct',label:'采购行动',type:'lookCode',lookCode:'TTA_NPP_ACTION'}
                                           ]"
                             ng-model="params"
                        ></div>

                        <div class="row"></div>

                    </form>
                </div>

                <div class="col-xs-12 col-md-12" style="margin-right: -1px; height: 100%;">
                    <form id="NPPReportForm" name="NPPReportForm" >
                        <div id ="parentFixedId" style="" main-scroll-style><!--ng-nicescroll="" nice-option="{oneaxismousemode:true,railvalign: 'bottom',cursorcolor:'#1e90c2'}"-->
                            <div class="data-table" id ="fixedId"  style ="height:85%;overflow:auto;"
                        >
                            <table saaf-table="dataTable"
                                   data-url="findTtaNppInfo"
                                   data-after-get-data="afterGetData()"
                                   data-params="params"
                                   data-checked-type="radio"
                                   data-auto-get-data="true"
                                   data-page-rows="30"
                                   class=" nicescroll-height  table table-bordered table-hover table-condensed">
                                <thead class="bg-gray-white">
                                    <tr class="text-center">
                                        <th>
                                            <input  ng-checked="selectedAll" type="checkbox"
                                                    ng-click="checkedAll($event)" >
                                        </th>
                                        <th>序号</th>
                                        <th>Month</th>
                                        <th>产品编号</th>
                                        <th>产品名称</th>
                                        <th>GROUP_CODE</th>
                                        <th>GROUP_DESC</th>
                                        <th>DEPT_CODE</th>
                                        <th>DEPT_DESC</th>
                                        <th>品牌_CN</th>
                                        <th>品牌_EN</th>
                                        <th>供应商编号</th>
                                        <th>供应商名称</th>
                                        <th>活动内容</th>
                                        <th>店铺数量</th>
                                        <th>Non-CVW/CVW<br>
                                            非寄售经仓/寄售经仓
                                        </th>
                                        <th>EB /Non-EB<br>
                                            独家产品/非独家产品
                                        </th>
                                        <th>收取方式</th>
                                        <th>合同条款</th>
                                        <th>收费标准</th>
                                        <th>收费单位</th>
                                        <th>应收金额(不含加成)</th>
                                        <th>应收金额(含加成)</th>
                                        <th>采购确认供应商编码</th>
                                        <th>采购确认供应商名称</th>
                                        <th>采购确认收取金额(不含加成)</th>
                                        <th>采购确认收取金额(含加成)</th>
                                        <th>采购确认TOTAL店铺数</th>
                                        <th>原应收金额(不含加成)</th>
                                        <th>调整应收金额(不含加成)</th>
                                        <th>调整应收金额(含加成)</th>
                                        <th>调整实收金额</th>
                                        <th>追加应收金额</th>
                                        <th>差异<br>（仅计算负数)</th>
                                        <th>TTA/OnTop</th>
                                        <!--<th><div style="width: 170px;">文件</div></th>-->
                                        <th><div style="width: 170px;">文件操作</div></th>

                                        <th>采购行动</th>
                                        <th>豁免原因-1</th>
                                        <th>豁免原因-2</th>
                                        <th>借记单编号</th>
                                        <th>备注</th>
                                        <th>ABOI系统实收金额</th>
                                        <th>提交人</th>
                                        <th>调整人</th>
                                        <th>转办人</th>
                                        <th>被转办人</th>
                                        <th>当前审批人</th>
                                        <th>批次编号</th>
                                        <th>流程单据号</th>
                                        <th>流程状态</th>

                                       <!-- <th>转办人(转入)</th>
                                        <th>转办时间(转入)</th>
                                        <th>转办人(转出)</th>
                                        <th>转办时间(转出)</th>
                                        <th>转办人(LAST_转出)</th>
                                        <th>转办时间(LAST_转出)</th>-->
<!--                                        <th>创建人</th>
                                        <th>创建时间</th>
                                        <th>更新人</th>
                                        <th>更新时间</th>-->
                                    </tr>
                                </thead>
                                <tbody ng-show="dataTable.data">
                                <tr class="text-center" ng-repeat="row in dataTable.data"
                                    ng-class="{'active':dataTable.data.selectRow==$index}"
                                    ng-click="dataTable.data.selectRow=$index;
                                     dataTable.data.selectRowData =row;" >

                                    <td>
                                        <input id="{{ nPPTable +'_'+row.nppId}}" ng-checked="row.checked" type="checkbox"
                                               ng-click="check(row,$event)" name="keys">
                                    </td>
                                    <td ng-bind="$index+1" class="w50">1</td>
                                    <td><span>{{row.month}}</span></td>
                                    <td><span>{{row.itemCode}}</span></td>
                                    <td><span>{{row.itemDescCn}}</span></td>
                                    <td>
                                        <span>{{row.groupCode}}</span>
                                        <!--<div class="input-group input-group-xs">
                                            <input class="form-control input-xs" required
                                                   ng-model="row.groupCode" name="{{'groupCode' + $index}}"
                                            >
                                        </div>-->
                                    </td>
                                    <td><span>{{row.groupDesc}}</span></td>
                                    <td><span>{{row.deptCode}}</span></td>
                                    <td><span>{{row.deptDesc}}</span></td>
                                    <td><span>{{row.brandCn}}</span></td>
                                    <td><span>{{row.brandEn}}</span></td>
                                    <td><span>{{row.vendorNbr}}</span></td>
                                    <td><span>{{row.vendorName}}</span></td>
                                    <td><!--活动内容-->
                                        <span ng-if="!(userType == '45')">{{row.activity}}</span>

                                        <div class="input-group input-group-xs"  ng-if="userType == '45'" style="width: 400px;" ng-disabled="row.processStatus && row.processStatus!='DS01'">
                                            <input class="form-control input-xs"
                                                   ng-model="row.activity">
                                        </div>
                                    </td>
                                    <td><!--店铺数据-->
                                        <!--<span>{{row.storeCoun}}</span>-->
                                        <div class="input-group input-group-xs">
                                            <input class="form-control input-xs" required ng-disabled="row.processStatus && row.processStatus!='DS01'"
                                                   ng-model="row.storeCoun" name="{{'storeCoun' + $index}}"
                                            >
                                        </div>
                                    </td>
                                    <td><span>{{row.ctw}}</span></td>
                                    <td><span>{{row.eb}}</span></td>

                                    <td><!--收取方式-->
                                        <div class="input-group input-group-xs" style="width: 120px;">
                                            <div lookup-code="NEW_PAYMENT" data-first-text="请选择"    ng-model="row.collectWay" required ng-disabled="!(userType == '45')"></div>
                                        </div>
                                    </td>
                                    <td><span>{{row.contractTerms}}</span></td>
                                    <!--<span>{{row.collectWayName}}</span>-->
                                    <td><!--收费标准--><!-- <span>{{row.chargeStandards | number:0}}</span>-->
                                        <div class="input-group input-group-xs" style="width: 100px;" >
                                            <input class="form-control input-xs" required ng-disabled="!(userType == '45')"
                                                   ng-model="row.chargeStandards" to-change-number name="{{'chargeStandards' + $index}}"
                                            >
                                        </div>
                                    </td>
                                    <td><!--收费单位--><!--<span>{{row.chargeUnit}}</span>-->
                                        <div class="input-group input-group-xs" style="width: 100px;">
                                            <div lookup-code="NB_UNIT" data-first-text="请选择"    ng-model="row.chargeUnit" required ng-disabled="!(userType == '45')"></div>
                                        </div>

                                    </td>
                                    <td><span>{{row.receiveAmount | number:0}}</span></td><!--应收金额(不含加成)-->
                                    <td><span>{{row.receiveAmountAdd | number:0}}</span></td><!--应收金额(含加成)-->
                                    <td><!--采购确认供应商编码-->
                                        <div class="input-group input-group-xs"   style="width: 100px;">
                                            <input class="form-control radius3" ng-model="row.priorVendorCode" name="{{'priorVendorCode'+$index}}"
                                                   readonly  type="text" ng-required="row.checked" style="width: 85px;"/>
                                            <span class="input-group-btn ng-scope">
                                                                    <button class="btn btn-default"  ng-click="clearVendor()" ng-disabled="row.processStatus && row.processStatus!='DS01'"
                                                                            type="button"><i class="fa fa-remove"></i></button>
                                                                    <button class="btn btn-default" ng-click="getVendorRow()" type="button" ng-disabled="row.processStatus && row.processStatus!='DS01'">
                                                                        <i class="fa fa-search"></i>
                                                                    </button>
                                                                </span>
                                        </div>
                                    </td>
                                    <!--采购确认供应商编码-->
                                    <td><span>{{row.priorVendorName}}</span></td>
                                    <td><!--需采购确认收取金额(不含加成)-->
                                        <!--<span>{{row.unconfirmAmount}}</span>-->
                                       <!-- <div class="input-group input-group-xs" style="width: 172px;" >
                                            <input class="form-control input-xs" ng-required="true"
                                                   ng-model="row.unconfirmAmount" to-change-number name="{{'unconfirmAmountNew' + $index}}"
                                                   ng-click="windowSplit(row)">
                                        </div>-->

                                        <div class="input-group input-group-xs" style="width: 172px;" >
                                            <input class="form-control input-xs" ng-required="row.checked" ng-disabled="row.processStatus && row.processStatus!='DS01'"
                                                   ng-model="row.unconfirmAmount" to-change-number name="{{'unconfirmAmountNew' + $index}}"
                                                   ng-change="countDifferenceAmt(row)"
                                                   ng-blur="blurEvent(row)"
                                                   placeholder="请输入整数" title="请输入整数" ng-pattern="/^\d+$/"
                                            >
                                        </div>
                                    </td>
                                    <td><!--采购确认收取金额(含加成)-->
                                        <!--<span>{{row.unconfirmAmount}}</span>-->
                                        <!--ng-disabled="!(userType == '45')"-->
                                        <!--ng-value="row.unconfirmAmountA=((row.unconfirmAmount * (100+ (row.additionRate ? row.additionRate : 0) * 1)/100).toFixed(0))"-->
                                        <div class="input-group input-group-xs" style="width: 172px;" >
                                            <input class="form-control input-xs" ng-required="row.checked" ng-disabled="true"
                                                   ng-model="row.unconfirmAmountA" to-change-number name="{{'unconfirmAmountANew' + $index}}"
                                                   >
                                        </div>
                                    </td>
                                    <td><!--采购确认TOTAL店铺数-->
                                        <div class="input-group input-group-xs" style="width: 172px;" >
                                            <input class="form-control input-xs" ng-required="true" ng-disabled="row.processStatus && row.processStatus!='DS01'"
                                                   ng-model="row.affirmTotStoreCount" to-change-number name="{{'affirmTotStoreCount' + $index}}"
                                            >
                                        </div>
                                    </td>
                                    <td><span>{{row.originalBeforeAmount | number:0}}</span></td><!--应收金额(不含加成)-->
                                    <td><!--调整应收金额(不含加成)-->
                                        <div class="input-group input-group-xs"   style="width: 100px;" ng-if="userType == '45'">
                                            <!--ng-disabled="row.processStatus && row.processStatus!='DS01'"-->
                                            <input class="form-control input-xs"  name = "{{'adjustReceiveAmount' + $index}}"
                                                   ng-model="row.noAdjustReceiveAmount" to-change-number>
                                        </div>
                                        <span ng-if="!(userType == '45')">{{row.noAdjustReceiveAmount | number:0}}</span>
                                    </td>
                                    <td><!--调整应收金额(含加成)-->
                                        <div class="input-group input-group-xs"   style="width: 100px;" ng-if="userType == '45'">
                                            <!--ng-disabled="row.processStatus && row.processStatus!='DS01'"-->
                                            <input class="form-control input-xs"  name = "{{'adjustReceiveAmount' + $index}}"
                                                   ng-model="row.adjustReceiveAmount" to-change-number
                                                   ng-value="row.adjustReceiveAmount = (row.collectSelect == 'TTA' ? (row.noAdjustReceiveAmount * (100+ (row.additionRate?row.additionRate : 0) *1)/100).toFixed(0) : row.noAdjustReceiveAmount )">
                                        </div>
                                        <span ng-if="!(userType == '45')">{{row.adjustReceiveAmount | number:0}}</span>
                                    </td>
                                    <td><!--调整实收金额-->
                                        <div class="input-group input-group-xs"   style="width: 100px;" ng-if="userType == '45'">
                                            <!--ng-disabled="row.processStatus && row.processStatus!='DS01'"-->
                                            <input class="form-control input-xs"  name = "{{'adjustAmount' + $index}}"
                                                   ng-model="row.adjustAmount" to-change-number>
                                        </div>
                                        <span ng-if="!(userType == '45')">{{row.adjustAmount | number:0}}</span>
                                    </td>
                                    <td><!--追加应收金额-->
                                        <span>{{row.addReceiveAmount | number:0}}</span>
                                    </td>
                                    <td> <!--差异(含加成)-->
                                        <div style="width: 150px">
                                        <!--<span>{{row.difference}}</span>-->
                                            <!--ng-value="row.difference = ((row.unconfirmAmountA - row.receiveAmountAdd - row.adjustReceiveAmount * 1) <0 ? (row.unconfirmAmountA - row.receiveAmountAdd - row.adjustReceiveAmount * 1).toFixed(0) : 0 )"-->
                                            <input class="form-control input-xs" ng-required="true"
                                               ng-model="row.difference" to-change-number name="{{'difference' + $index}}" disabled
                                            >
                                        </div>
                                    </td>
                                    <td><!--TTA/OnTop 选择-->
                                        <div class="input-group input-group-xs" style="width: 84px;">
                                            <div lookup-code="TTA_COLLECTION_METHOD" data-first-text="请选择"    ng-model="row.collectSelect" required ng-disabled="row.processStatus && row.processStatus!='DS01'"></div>
                                        </div>
                                    </td>
                                    <td><!--文件操作-->
                                        <a  type="button" ng-click="fileInfoFunc(row)" style="cursor:pointer;white-space:nowrap">文件详情</a>
                                    </td>

                                    <td><!--采购行动-->
                                        <div class="input-group input-group-xs" style="width: 172px;">
                                            <div class="input-group input-group-xs">
                                                <div lookup-code="TTA_NPP_ACTION" ng-if="!(row.type && row.type=='2')" ng-disabled="row.processStatus && row.processStatus!='DS01' && !(userType == '45')"
                                                     ng-required="row.checked"
                                                     name="{{'purchaseAct'+$index}}"
                                                     data-first-text="请选择"
                                                     data-paramcallback="purchaseFun"
                                                     data-row="{{dataTable.data.indexOf(row)}}"
                                                     ng-model="row.purchaseAct">
                                                </div>

                                                <div lookup-code="TTA_DM_ADJ_ACTION"  ng-if="row.type && row.type=='2'" ng-disabled="row.processStatus && row.processStatus!='DS01' && !(userType == '45')"
                                                     ng-required="row.checked"
                                                     name="{{'purchaseAct'+$index}}"
                                                     data-first-text="请选择"
                                                     data-paramcallback="purchaseFun"
                                                     data-row="{{dataTable.data.indexOf(row)}}"
                                                     ng-model="row.purchaseAct"></div>
                                            </div>
                                        </div>

                                    </td>
                                    <td title="{{row.exemptionReason}}">
                                        <div class="input-group input-group-xs" style="width: 172px;">
                                            <select class="form-control radius3" ng-disabled="row.processStatus && row.processStatus!='DS01' && !(userType == '45')"
                                                    ng-change ="exemptionReasonListChangeIn(row,row.exemptionReasonList,row.exemptionReason)"
                                                    ng-required="row.exemptionReasonList && row.exemptionReasonList.length>0 && (row.purchaseAct=='A11' || row.purchaseAct == 'A10') && row.checked"
                                                    ng-model  ="row.exemptionReason">
                                                <option value ="">{{firstText}}</option>
                                                <option ng-bind="iterm.meaning"
                                                        ng-repeat="iterm in row.exemptionReasonList"
                                                        value="{{iterm.lookupCode}}"></option>
                                            </select>
                                        </div>
                                    </td>
                                    <td title="{{row.exemptionReason2}}">
                                        <div class="input-group input-group-xs" style="width: 172px;">
                                            <!--row.exemptionReasonList2 && row.exemptionReasonList2.length>0 && row.checked-->
                                            <select class="form-control radius3" ng-disabled="row.processStatus && row.processStatus!='DS01' && !(userType == '45')"
                                                    ng-required="row.exemptionReasonList2 && row.exemptionReasonList2.length>0 && row.checked"
                                                    ng-model  ="row.exemptionReason2">
                                                <option value ="">{{firstText}}</option>
                                                <option ng-bind="iterm.meaning"
                                                        ng-repeat="iterm in row.exemptionReasonList2"
                                                        value="{{iterm.lookupCode}}"></option>
                                            </select>
                                        </div>
                                    </td>
                                    <td><!--借记单编号-->
                                        <span ng-if="!(userType == '45')">{{row.debitOrderCode}}</span>
                                        <div class="input-group input-group-xs" style="width: 172px;" ng-if="userType == '45'">
                                            <!--ng-disabled="row.processStatus && row.processStatus!='DS01'"-->
                                            <input class="form-control input-xs" ng-required="row.purchaseAct=='A02' && row.checked"
                                                   ng-model="row.debitOrderCode">
                                        </div>
                                    </td>
                                    <td><!--备注-->
                                        <div class="input-group input-group-xs">
                                            <!--ng-required="row.purchaseAct=='A01' && row.difference < 0 &&  row.checked"-->
                                            <input class="form-control input-xs" style="width: 100px;" ng-disabled="row.processStatus && row.processStatus!='DS01' && !(userType == '45')"
                                                   ng-model="row.remark" name="{{'remark' + $index}}"
                                            >
                                        </div>
                                    </td>
                                    <td>
                                        <span ng-if="!(userType == '45')">{{row.aboiReceipts}}</span>
                                        <!--ng-disabled="row.processStatus && row.processStatus!='DS01'"-->
                                        <div class="input-group input-group-xs" style="width: 172px;" ng-if="userType == '45'">
                                            <input class="form-control input-xs"
                                                   ng-model="row.aboiReceipts">
                                        </div>
                                    </td>
                                    <td><span>{{row.submitUserName}}</span></td>
                                    <!--调整人-->
                                    <td>
                                        <span ng-if="!(userType == '45')">{{row.adjustByName}}</span>
                                        <div ng-if="userType == '45'" class="input-group input-group-xs"   style="width: 100px;">
                                            <input class="form-control radius3" ng-model="row.adjustByName" name="{{'adjustByName'+$index}}"
                                                   readonly  type="text"/>
                                            <!--ng-disabled="row.processStatus && row.processStatus!='DS01'"-->
                                            <span class="input-group-btn ng-scope">
                                                <button class="btn btn-default" ng-click="getNameL()" type="button" >
                                                    <i class="fa fa-search"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </td>

                                    <!--转办人-->
                                    <td><span>{{row.transferLastPersonName}}</span></td>
                                    <!--被转办人-->
                                    <td><span>{{row.transferInPersonName}}</span></td>
                                    <td><span>{{row.currentUserName}}</span></td>
                                    <td><span>{{row.batchCode}}</span></td>
                                    <td><a href="javascript:" ng-click="getRow(row)">{{row.processCode}}</a></td>
                                    <td>{{row.processStatusName}}</td>

                                    <!--以下为转办人相关的信息-->
<!--                                    <td><span>{{row.transferInPersonName}}</span></td>
                                    <td><span>{{row.transferInDate}}</span></td>
                                    <td><span>{{row.transferOutPersonName}}</span></td>
                                    <td><span>{{row.transferOutDate}}</span></td>
                                    <td><span>{{row.transferLastPersonName}}</span></td>
                                    <td><span>{{row.TransferLastDate}}</span></td>-->

<!--                                    <td><span>{{row.createdByName}}</span></td>
                                    <td><span>{{row.creationDate}}</span></td>
                                    <td><span>{{row.lastUpdatedByName}}</span></td>
                                    <td><span>{{row.lastUpdateDate}}</span></td>-->
                                    <!--                                    <td>-->
                                    <!--                                        <div class="input-group input-group-xs">-->
                                    <!--                                            <div lookup-code="BASE_USER_DT" data-first-text="请选择类型"    ng-model="row.dataType"></div>-->
                                    <!--                                        </div>-->
                                    <!--                                    </td>-->
                                    <!--<td><a href="javascript:" ng-click="usersAuthorityParams2.userId = row.userId;usersAuthorityTable2.getData()">点我</a></td>-->
                                </tr>
                                </tbody>
                            </table>
                            <div saaf-table-tfoot="dataTable" ng-show="dataTable.data.length>0"></div>

                        </div>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </form>

    <div class="modal fade" id="excelTtaNppNewProductLine" data-des="excel_ttaNppNewProductLine" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabell">
                        导入
                    </h4>
                </div>
                <form class="ngValid" name="ttaNppNewProductLineForm"  >
                    <div class="modal-body">
                        <div class="form-group col-xs-12 col-md-12" ng-if="buttonFlag">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn">
                                    <span class="w100">选择文件</span></label>
                                <input type="file" required accept="*.xlsx"  id="fileUpLoad">
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-md-12" ng-if="!buttonFlag">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn">
                                    <span class="w100">当前阶段：</span></label>
                                <span id="value1"></span>
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-md-12" ng-if="!buttonFlag">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn">
                                    <span class="w100">当前行(列)数：</span></label>
                                <span id="value2"></span>
                            </div>
                        </div>
                        <div class="cb"></div>
                    </div>

                    <div class="modal-footer " ng-if="buttonFlag">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="save(ttaNppNewProductLineForm.$invalid)" validate-form-btn="" data-validate-form="ttaNppNewProductLineForm" id="saveButton1" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div class="modal fade" id="PLDelete" data-des="批量删除" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog " style="width: 300px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabe1">
                        选择月份
                    </h4>
                </div>
                <form class="ngValid" name="funcMenuForm"  >
                    <div class="modal-body">
                        <div class="form-group col-xs-12 col-md-12">
                            <div class="input-group input-group-xs">
                                <label class="input-group-addon bn">
                                    <span class="w100">促销区间</span></label>
                                <input  type="text" ng-model="paramsPL.month" required
                                        class="form-control radius3">
                            </div>
                        </div>
                        <div class="cb"></div>
                    </div>

                    <div class="modal-footer " ng-if="buttonFlag">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="saveWindow(funcMenuForm.$invalid)" validate-form-btn="" data-validate-form="funcMenuForm" id="saveButton" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div class="modal fade" id="addFileUpload" data-des="文件上传" data-backdrop="static" tabindex="-1" style="z-index: 1065;">
        <div class="modal-dialog " style="width: 600px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        文件上传
                    </h4>
                </div>
                <form class="ngValid" name="funcMenunPPForm"  >
                    <div class="modal-body">
                        <div class="form-group col-xs-12 col-md-12">
                            <div class="btn-group btn-group-xs" style="">
                                <input  type="file" id ="nPPReportUploadFile" name="nPPReportUploadFile"  emms-file-upload="myFile">
                            </div>
                        </div>
                        <div class="cb"></div>
                    </div>

                    <div class="modal-footer ">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="uploadFile(funcMenunPPForm.$invalid)" validate-form-btn="" data-validate-form="funcMenunPPForm" id="saveButton2" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <!--拆分-->
    <div class="modal fade" id="nPPSplit" data-des="拆分" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog " style="width: 500px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabe3">
                        请填写
                    </h4>
                </div>
                <form class="ngValid" name="funcMenuFormNppSplit"  >
                    <div>
                        <label style="margin-left: 10px"><i class="fa fa-list-alt"></i>详情</label>
                        <div  class="btn-group btn-group-xs ml5 pull-right">
                            <button type="button" class="btn btn-default btn-xs " ng-disabled="splitDataTable.selectRow==undefined" ng-click="btnDelRow()"><i class="fa fa-trash-o fa-lg"></i>删除</button>
                            <button type="button" class="btn btn-default btn-xs" ng-click="btnNewRow()"><i class="fa fa-plus">增加</i></button>
                        </div>

                    </div>


                    <div class="data-table">
                        <table
                                class="table table-bordered table-hover table-condensed">
                            <thead class="bg-gray-white">
                            <tr class="text-center">
                                <th>采购确认收取金额</th>
                                <th>供应商</th>
                                <th>供应商名称</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="text-center" ng-repeat="row in splitDataTable"
                                ng-class="{'active':splitDataTable.selectRow==$index}"
                                ng-click="splitDataTable.selectRow=$index">
                                <td>
                                    <div class="input-group input-group-xs">
                                        <input class="form-control radius3" ng-model="row.unconfirmAmount" name="{{'unconfirmAmountNpp_split'+$index}}"
                                               required type="text"  to-change-number />
                                    </div>
                                </td>
                                <td>
                                    <!--<div class="input-group input-group-xs">
                                    </div>-->
                                    <div class="input-group input-group-xs">
                                        <input class="form-control radius3" ng-model="row.vendorNbr" name="{{'vendorNbr_split'+$index}}"
                                               readonly required type="text"/>
                                        <span class="input-group-btn ng-scope">
                                            <button class="btn btn-default" ng-click="getVendorL()" type="button">
                                                <i class="fa fa-search"></i>
                                            </button>
                                        </span>
                                    </div>
                                </td>
                                <td>
                                    <span>{{row.vendorName}}</span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="modal-footer " ng-if="buttonFlag">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal">取消
                            </button>
                            <button ng-click="saveWindow(funcMenuFormNppSplit.$invalid)" validate-form-btn="" data-validate-form="funcMenuFormNppSplit" id="saveButton3" class="btn btn-primary mr10">确定</button>
                        </div>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <!--选择供应商弹窗-->
    <div data-auto-request="true" data-callback="selectSupplierReturn" data-checked-type="radio"
         data-dynamic-params="{flag:'isNew'}" data-keys="{'key':'supplierCode','value':'supplierCode','name':'供应商编码'}"
         data-other-column="[{'name':'供应商名称','key':'supplierName'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'supplierCode','placeholder':'供应商编码'},
                          {'key':'supplierName','placeholder':'供应商名称'}]"
         data-show-index="false"
         data-title="选择供应商信息"
         data-type="competitor"
         data-url="supplierFindLov"
         id="nPPReportListId"
         lov-list="nPPReportList"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <!--转办人弹窗-->
    <div data-auto-request="true" data-callback="selectTransferReturn" data-checked-type="radio"
         data-other-column="[{key:'userName',name:'账号'},{key:'userFullName',name:'员工姓名'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'userFullName','placeholder':'请输入员工姓名'},{'key':'userName','placeholder':'请输入员工账号'}]"
         data-show-index="false"
         data-title="选择转办人"
         data-type="competitor"
         data-keys="{'key':'userName','value':'userFullName','name':'账号',hide:'true'}"
         data-url="processFindInternalUsers"
         id="lovnPPReportFind"
         lov-list="lovnPPReportFind"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <!--GROUP -->
    <div lov-list="groupLov" role="dialog" data-title="选择GROUP信息" id="groupLov" ng-model="current.params"
         data-url="itemFind"
         data-dynamic-params='{"findFlag": "findGroup"}'
         data-callback="selectGroupReturn"
         data-auto-request="true"
         data-return-type="key"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="checkbox"
         data-keys="{'key':'groupCode','value':'groupCode','name':'GROUP_CODE'}"
         data-show-index="false"
         data-type="competitor"
         data-other-column="[{'name':'GROUP_DESC','key':'groupDesc'}]"
         data-search-key="[{'key':'groupCode','placeholder':'GROUP_CODE'},
                          {'key':'groupDesc','placeholder':'GROUP_DESC'}]"
    >
    </div>

    <!--DEPT-->
    <div lov-list="deptLov" role="dialog" data-title="选择部门信息" id="deptLov" ng-model="current.em"
         data-url="itemFind"
         data-dynamic-params='{"findFlag": "findDept"}'
         data-callback="selectDeptReturn"
         data-auto-request="true"
         data-return-type="key"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="radio"
         data-keys="{'key':'departmentCode','value':'departmentCode','name':'部门编码'}"
         data-show-index="false"
         data-type="competitor"
         data-other-column="[{'name':'部门名称','key':'departmentName'}]"
         data-search-key="[{'key':'departmentCode','placeholder':'部门编码'},
                          {'key':'departmentName','placeholder':'部门名称'}]"
    >
    </div>

    <!--BRAND-->
    <div lov-list="brandLov" role="dialog" data-title="选择BRAND" id="brandLov" ng-model="current.em"
         data-url="itemFind"
         data-dynamic-params='{"findFlag": "findBrand"}'
         data-callback="selectBrandReturn"
         data-auto-request="true"
         data-return-type="key"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="radio"
         data-keys="{'key':'brandCode','value':'brandCode','name':'BRAND_CODE'}"
         data-show-index="false"
         data-type="competitor"
         data-other-column="[{'name':'BRAND_CN','key':'brandCn'},{'name':'BRAND_EN','key':'brandEn'}]"
         data-search-key="[{'key':'brandCode','placeholder':'BRAND_CODE'},
                          {'key':'brandCn','placeholder':'BRAND_CN'},
                          {'key':'brandEn','placeholder':'BRAND_EN'}]"
    >
    </div>

    <!--ITEM-->
    <div data-auto-request="true"
         data-callback="selectItemLovReturn"
         data-checked-type="radio"
         data-keys="{'key':'itemNbr','value':'itemNbr','name':'物料编码'}"
         data-other-column="[{'name':'ITEM英文','key':'itemDescEn'},{'name':'ITEM中文','key':'itemDescCn'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'itemNbr','placeholder':'物料编码'},
                          {'key':'itemDescEn','placeholder':'ITEM英文'},
                          {'key':'itemDescCn','placeholder':'ITEM中文'}]"
         data-show-index="false"
         data-title="选择TIME信息"
         data-type="competitor"
         data-url="itemFindLov"
         id="itemLov"
         lov-list="itemLov"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <div data-auto-request="true" data-callback="selectdjustByReturn" data-checked-type="radio"
         data-other-column="[{key:'userName',name:'账号'},{key:'userFullName',name:'员工姓名'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'userFullName','placeholder':'请输入员工姓名'},{'key':'userName','placeholder':'请输入员工账号'}]"
         data-show-index="false"
         data-title="选择调整人"
         data-type="competitor"
         data-keys="{'key':'userName','value':'userFullName','name':'账号',hide:'true'}"
         data-url="processFindInternalUsers"
         id="lovNPPReportAdjustByFind"
         lov-list="lovNPPReportFindMan2"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <!--文件详情弹出框-->
    <div class="modal fade" id="excelUp2" data-des="EXCEL_UP" data-backdrop="static" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="fileImportId">
                        文件
                    </h4>
                </div>

                <div style="text-align:right;margin:0px auto 0px auto">
                    <div class="btn-group btn-group-xs ml5 ">
                        <button type="button" ng-disabled="ttaNppfileDataTable.selectRow == undefined"   ng-click="delUploadFile()" class="btn btn-default btn-xs"  id="del"> <i class="fa fa-trash">删除</i></button>
                        <button type="button"  ng-click="callback(dataTable.data.selectRowData,dataTable.data.selectRow,'upload')" class="btn btn-primary btn-xs"  id="saveFile"><i class="fa fa-plus">上传附件</i></button>
                    </div>
                </div>
                <div class="data-table">
                    <div base-data-table="ttaNppfileDataTable" id = "ttaNppfileDataTableId"
                         ng-params="fileDataParams"
                         data-keys="{'key':'functionId','value':'functionId','name':'模块id'}"
                         data-show-index="true"
                         data-auto-request="true"
                         data-url="findBaseAttachmentList"
                         data-legend="[
                                                                     {'value':'createdByUser','name':'上传人'},
                                                                     {'value':'creationDate','name':'上传时间'},
                                                                     {'value':'sourceFileName','name':'上传附件名称'},
                                                                 ]"
                         data-func-column = "[{'icon':'fa fa-download','text':'下载附件','callback':'downFileEvent'}]"

                    >
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <!--选择供应商-->
    <div data-auto-request="true" data-callback="selectSupplierLineReturn" data-checked-type="radio"
         data-dynamic-params="{flag:'isAdditionRate'}" data-keys="{'key':'supplierCode','value':'supplierCode','name':'供应商编码'}"
         data-other-column="[{'name':'供应商名称','key':'supplierName'},{'name':'加成比例','key':'additionRate'}]"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-return-type="key"
         data-search-key="[{'key':'supplierCode','placeholder':'供应商编码'},
                          {'key':'supplierName','placeholder':'供应商名称'}]"
         data-show-index="false"
         data-title="选择供应商信息"
         data-type="competitor"
         data-url="supplierFindLov"
         id="nPPReportLineId"
         lov-list="nPPReportLineList"
         ng-model="current.em"
         role="dialog"
    >
    </div>

    <!--采购批量回复-->
    <form id="nppPurchaseReplyForm" name="nppPurchaseReplyForm" ng-submit="saveNppPurchaseReply(nppPurchaseReplyForm)">
        <div class="modal fade" id="nppPurchaseReplyModal" data-backdrop="static" data-keyboard="false" tabindex="-1"
         role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog " style="margin-top: 30px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"
                            aria-hidden="true">&times;
                    </button>
                    <h4 class="modal-title" id="purchaseReplyTitle">
                        采购批量回复
                    </h4>
                </div>
                <div class="w80p h20" style=""></div>
                <div class="modal-body ">
                    <div class="pl30 pr30">
                        <div class="row">
                            <div class="form-group col col-xs-11 col-md-6" >
                                <div class="input-group input-group-xs">
                                    <label class="input-group-addon bn"><span class="w100"><i class="red">*</i>采购行动：</span></label>
                                    <div lookup-code="TTA_NPP_ACTION"
                                         required
                                         name="purchaseActReply"
                                         data-first-text="请选择"
                                         data-callback="purchaseReplyFun"
                                         ng-model="currentPurcahseReply.purchaseAct">
                                    </div>

                                </div>
                            </div>

                            <div class="form-group col col-xs-11 col-md-6" >
                                <div class="input-group input-group-xs">
                                    <label class="input-group-addon bn"><span class="w100"><i class="red">*</i>豁免原因_1：</span></label>
                                    <select class="form-control radius3"
                                            name="exemptionReasonReply"
                                            ng-change ="exemptionReasonListChangeByModal()"
                                            ng-model  ="currentPurcahseReply.exemptionReason">
                                        <option value ="">{{firstText}}</option>
                                        <option ng-bind="iterm.meaning"
                                                ng-repeat="iterm in currentExemptionReasonList"
                                                value="{{iterm.lookupCode}}"></option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group col col-xs-11 col-md-6" >
                                <div class="input-group input-group-xs">
                                    <label class="input-group-addon bn"><span class="w100">豁免原因_2：</span></label>
                                    <select class="form-control radius3"
                                            name="exemptionReason2Reply"
                                            ng-model="currentPurcahseReply.exemptionReason2">
                                        <option value ="">{{firstText}}</option>
                                        <option ng-bind="iterm.meaning"
                                                ng-repeat="iterm in currentExemptionReasonList2"
                                                value="{{iterm.lookupCode}}"></option>
                                    </select>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="margin-top: 20px;">
                    <div style="text-align: center">
                        <button style="" type="button" class="btn btn-default btn-sm" data-dismiss="modal">取消</button>

                        <button id="submitNppPurchaseReply"  type="submit" class="btn btn-primary btn-sm">
                            <span>保存</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </form>
</div>