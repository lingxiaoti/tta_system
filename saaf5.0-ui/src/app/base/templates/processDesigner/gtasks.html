<div ng-controller="gtasksCtrl" class="gridtable">
    <div class="form bg-white" inner-frame data-des="此节点必需－内框页面的指令">
        <!--------------------- 按钮--->
        <div class="bg-gray-white bt">
            <div class="bg-gray-white p5">
                <div class="pull-right ">
                    <div class="btn-group btn-group-xs ml10">
                        <button class="btn btn-default" type="button" ng-click="gtasksTable.search(1)">
                            <i class="fa fa-search" aria-hidden="true"></i>搜索
                        </button>
                        <button class="btn btn-default" type="button" ng-click="gtasksTable.restore('type')">
                            <i class="fa fa-undo" aria-hidden="true"></i>重置
                        </button>
                    </div>
                    <div class="btn-group btn-group-xs ml10" permission-buttons="btnNew,btnModify,btnInvalid,btnDel" data-disabled-for-table="gtasksTable" >
                        　
<!--

                        <button class="btn btn-default" type="button" ng-click="btnNew()">
                            <i class="fa fa-plus" aria-hidden="true"></i>新增
                        </button>
                        <button class="btn btn-default" type="button" ng-click="btnModify()">
                            <i class="fa fa-edit" aria-hidden="true"></i>编辑
                        </button>
                        <button class="btn btn-default" type="button" ng-click="btnDisabled()">
                            <i class="fa fa-refresh" aria-hidden="true"></i>失效
                        </button>-->
                        <button class="btn btn-default" type="button" ng-click="btnInvalid()" ng-disabled="!gtasksTable.selectRow">
                            <i class="fa fa-refresh" aria-hidden="true"></i>失效
                        </button>

                    </div>
                </div>

                <div class="btn-group btn-group-xs ">
                    <button type="button" class="btn  btn-warning" ng-click="moreInput($event)">
                        <i class="fa fa-chevron-circle-down"></i>高级查询
                    </button>
                    <button type="button" class="btn btn-primary" ng-click="fullWindow($event)">
                        <i class="fa fa-square-o"></i>数据全屏
                    </button>
                </div>
            </div>
        </div>
        <!---------------------  / .按钮  --->

        <div main-scroll-style data-des="此节点必需－用户计算滚动区域高度">
            <!--    <div class="col-md-2 br h100p">


                    <ul sie-ztree="categoryTree" style="margin-bottom: 10px;" class="ztree pt10 pb10" id="categoryTree"
                        data-url="processListCategories"
                        data-simpledata='{"enable":"true","idKey":"categoryId","pIdKey":"parentId","rootPId":-1}'
                        data-keys='{"name":"categoryName"}'
                        data-page-rows="10000"
                        data-expand-node="true"
                        data-node-click="treeClick"

                    >
                    </ul>
                </div>-->
            <div class="nicescroll-height  bg-white " ng-nicescroll
                 nice-option="{cursorcolor: '#998279',cursorwidth:10}" data-des="此节点必需-滚动内容及指令">

                <!--------------------- 输入表单  --->
                <form class=" mt10 pb5 input-form bb  " input-form data-des="此节点必需－用于识别输入表单的指令">
                    <div resp-change="" class=" col-xs-6 col-md-4 col-lg-3"></div>
                    <div search-form
                         data-legend="[
                         {ngStart:'startDate',ngEnd:'endDate',label:'委托时间',type:'dateTimeRange'},
                         {key:'status',label:'流程分类',type:'ztreeSelect',
                          options:{
                            url:'processListCategories',
                            label:'流程分类',
                            simpledata: {enable:true,idKey:'categoryId',pIdKey:'parentId',rootPId:-1},
                            keys: {name:'categoryName'},
                            height:250,
                            returnValue:'categoryName',
                            returnKey:'categoryId'
                          }
                          },
                          {key:'listName',label:'委托编号'},
                          {key:'clientUser',label:'委托人'},
                          {key:'delegateUser',label:'被委托人'},
                        ]"
                         ng-model="processParams"
                    ></div>
                </form>
                <!--------------------- ./  输入表单  --->



                <div class="p15">
                    <ul class="nav nav-tabs" ng-if="isAdmin != 'Y'">
                        <li class="active" ng-click="changeListType(1)"><a href="#gtasksTable"  data-toggle="tab">我的委托</a></li>
                        <li ng-click="changeListType(2)"><a href="#gtasksTable" data-toggle="tab">我被委托</a></li>
                    </ul>

                    <ul class="nav nav-tabs" ng-if="isAdmin == 'Y'">
                        <li class="active" ng-click="changeListType(1)"><a href="#gtasksTable"  data-toggle="tab">委托信息</a></li>
                    </ul>

                    <div class="data-table text-center mt15"  >
                        <div base-data-table="gtasksTable" id="gtasksTable"
                             data-url="findDelegateConfig" data-show-index='true'
                             data-delete-url="processDelegateDel"
                             data-keys="{'key':'configId',asKey:'configIds',delKeyType:'array'}"
                             ng-params="processParams"
                             data-click-row="clickRow"
                             data-callback="[{value:'bpm_title',callback:'clickColumns'}]"
                             data-func-column="[{'text':'查看流程范围','callback':'showRange'}]"
                             data-legend='[
                                {"value": "configId","name": "委托编号"},
                                {"value": "client_userFullName","name": "委托人"},
                                {"value": "delegate_userFullName","name": "被委托人"},
                                {"value": "startTime","name": "委托开始时间"},
                                {"value": "endTime","name": "委托结束时间"},
                                {"value":"enabled","name":"状态", boolean:"icon"}
                            ]'>
                        </div>
                    </div>
                </div>



            </div>
        </div>
    </div>
    <form name="entrustApprovalForm" id="entrustApprovalForm">
        <div class="modal fade" data-backdrop="static" id="entrustApproval" tabindex="-1">
            <div class="modal-dialog modal-dialog-md">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title">
                            委托审批
                        </h4>
                    </div>

                    <div class="modal-body ">
                        <div class="pl30 pr30">
                            <div class="row">
                                <div class="form-group col col-xs-12 col-md-12">
                                    <div z-tree-select="rangeTree"
                                         data-url="findCategoriesModels"
                                         data-simpledata='{"enable":"true","idKey":"categoryId","pIdKey":"parentId","name":"categoryName","rootPId":-1}'
                                         data-label="流程范围"
                                         ng-params="rangeTreeParams"
                                         data-label-css="auto"
                                         data-check="true"
                                         data-expand-node="1"
                                         data-height="200"
                                         ng-value="showParams.value"
                                         ng-key="showParams.key"
                                         ng-model="current.range"
                                         data-callback="setRangeVal"
                                         data-required='true'
                                    ></div>
                                </div>

                                <!--<div class="form-group col col-xs-12 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span
                                                class="">{{ $l('委托人') }}：</span></label>
                                        <input type="text" class="form-control radius3" required readonly
                                               ng-disabled="process.isEditProcess" name="showParams_currentUser"
                                               ng-model="showParams.currentUser">
                                    </div>
                                </div>-->

                                <div class="form-group col col-xs-12 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span
                                                class=""><i class="red">*</i>{{ $l('委托人') }}：</span></label>
                                        <input type="text" class="form-control radius3" name="showParams_currentUser"
                                               id="selectCurrentUser" required disabled
                                               ng-model="addParams.selectCurrentUser">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default" data-target="#LovCurrentUser" data-toggle="modal" ng-disabled="isAdmin != 'Y'">
                                                <i class="fa fa-search"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group col col-xs-12 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span
                                                class=""><i class="red">*</i>{{ $l('被委托人') }}：</span></label>
                                        <input type="text" class="form-control radius3" name="addParams_delegateUser"
                                               id="addParams_delegateUser" required disabled
                                               ng-model="addParams.delegateUser">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default" data-target="#LovDelegateUser" data-toggle="modal">
                                                <i class="fa fa-search"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>

                                <div class="form-group col col-xs-12 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span
                                                class=""><i class="red">*</i>{{ $l('开始时间') }}：</span></label>

                                        <input type="text" class="form-control radius3" name="addParams_startTime" required data-enddate="{{ addParams.endTime }}"
                                               id="addParams_startTime" date-time-picker="" data-date-format="yyyy-mm-dd" data-min-view="2"
                                               ng-model="addParams.startTime">
                                    </div>
                                </div>

                                <div class="form-group col col-xs-12 col-md-6">
                                    <div class="input-group input-group-xs">
                                        <label class="input-group-addon bn"><span
                                                class=""><i class="red">*</i>{{ $l('结束时间') }}：</span></label>

                                        <input type="text" class="form-control radius3" name="addParams_endTime" required data-stratdate="{{ addParams.startTime }}"
                                               id="addParams_endTime" date-time-picker="" data-date-format="yyyy-mm-dd" data-min-view="2"
                                               ng-model="addParams.endTime">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer ">
                        <div style="text-align:center">
                            <button style="" type="button" class="btn btn-default" data-dismiss="modal"
                                    aria-hidden="true">{{ $l('取消')}}
                            </button>
                            <button type="button" ng-click="save()"
                                    validate-form-btn="entrustApprovalForm" class="btn btn-primary mr10">{{ $l('提交')}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- /.modal -->
    </form>

    <div lov-list="LovDelegateUser" id="LovDelegateUser" data-url="processFindInternalUsers" ng-model="current.DelegateUser" data-title="审批人选择"
         data-search-key="[{'key':'userName','placeholder':'请输入账号'},{'key':'userFullName','placeholder':'请输入姓名'}]"
         data-return-key="addParams.delegateUserId"
         data-return-value="addParams.delegateUser"
         data-checked-type="radio"
         data-keys="{'key':'userId','value':'userName','name':'账号'}"
         data-other-column="[{'key':'userFullName','name':'姓名'}]"
    ></div>

    <div lov-list="LovCurrentUser" id="LovCurrentUser" data-url="processFindInternalUsers" ng-model="current.currentUser" data-title="审批人选择"
         data-search-key="[{'key':'userName','placeholder':'请输入账号'},{'key':'userFullName','placeholder':'请输入姓名'}]"
         data-return-key="addParams.selectDelegateUserId"
         data-return-value="addParams.selectCurrentUser"
         data-checked-type="radio"
         data-keys="{'key':'userId','value':'userName','name':'账号'}"
         data-other-column="[{'key':'userFullName','name':'姓名'}]"
    ></div>

    <div class="modal fade" data-backdrop="static" id="rangeModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">
                        委托范围
                    </h4>
                </div>
                <div class="modal-body ">
                    <div class="pl30 pr30">
                        <div class="row">
                            <div sie-ztree="showRangeTree" class="ztree" style="max-height: 300px; overflow-y: auto;"
                                 data-url="findCategoriesModels"
                                 data-expand-node="1"
                                 data-params ="{{ showRangeTreeParams }}"
                                 data-simpledata="{enable:true,idKey:'categoryId',pIdKey:'parentId',rootPId:-1}"
                                 data-keys='{"name":"categoryName"}'
                            ></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- /.modal -->
</div>