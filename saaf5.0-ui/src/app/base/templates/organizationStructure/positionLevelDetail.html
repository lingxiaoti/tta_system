<div ng-controller="positionLevelDetailCtrl" class="gridtable">
    <div class="bg-gray-white bt">
        <div class="bg-gray-white p5">
            <div class="btn-group btn-group-xs pull-right ml10" id="outputButton">
                <div resp-change="" style="display: none"></div>
                <button type="button" ng-click="btnSave()" permission-btn="btnSave" data-validate-form="addForm"
                        class="btn btn-default">
                </button>
            </div>
            <div class="btn-group btn-group-xs ">
                <button class="btn btn-primary" ng-click="fullWindow($event)">
                    <i class="fa fa-square-o"></i>{{$l('数据全屏')}}
                </button>
            </div>
        </div>
    </div>
    <div main-scroll-style data-des="此节点必需－用户计算滚动区域高度">
        <div class="nicescroll-height  bg-white " ng-nicescroll
             nice-option="{{niceOpction}}"
             data-des="此节点必需-滚动内容及指令">

            <!--------------------- 输入表单  --->

            <form name="addForm" class=" mt10 pb5 bb oh"
                  data-des="此节点必需－用于识别输入表单的指令">

                <header class="col-xs-12 mb10">
                    <i class="fa fa-cog" aria-hidden="true"></i>
                    <span>职位层级</span>
                </header>
                <div class="form-group col-xs-4 col-md-4">
                    <div class="input-group input-group-xs">
                        <label class="input-group-addon bn"><span class="w100">上级职位名称</span></label>
                        <input type="text" class="form-control radius3" ng-model="levelDetail.mgrPositionName" readonly>
                        <span class="input-group-btn ng-scope">
                            <button type="button" data-toggle="modal" data-target="#upPosition"
                                    class="btn btn-default"><i class="fa fa-search"></i></button>
                        </span>
                    </div>
                </div>
                <div class="form-group col-xs-4 col-md-4">
                    <div class="input-group input-group-xs">
                        <label class="input-group-addon bn"><span class="w100">上级人员姓名</span></label>
                        <input type="text" class="form-control radius3" ng-model="levelDetail.mgrPersonName" readonly>
                        <span class="input-group-btn ng-scope">
                            <button type="button" data-toggle="modal" data-target="#upPerson"
                                    ng-disabled="!levelDetail.mgrPositionName" class="btn btn-default"><i
                                    class="fa fa-search"></i></button>
                        </span>
                    </div>
                </div>
                <!--上级按钮-->
                <div class="form-group col-xs-4 col-md-4">
                    <div class="input-group input-group-xs">
                       <span class="input-group-btn ng-scope">
                                <button type="button" ng-click="findUpPosition()"
                                        ng-disabled="!levelDetail.mgrPositionName" class="btn btn-default"><i
                                        class="fa fa-level-up"></i></button>
                            </span>
                    </div>
                </div>
                <header class="col-xs-12 mb10">
                    <i class="fa fa-cog" aria-hidden="true"></i>
                    <span>职位信息</span>
                    <button type="button" class="btn btn-primary btn-xs pull-right" data-toggle="modal" data-target="#position">
                        <i class="fa fa-plus">选择职位</i>
                    </button>
                </header>
                <table class="nicescroll-height report-data">
                    <thead>
                    <tr>
                        <th>职位名称 <i class="red">*</i></th>
                        <th>人员姓名</th>
                        <th>是否生效 <i class="red">*</i></th>
                        <th>生效日期 <i class="red">*</i></th>
                        <th>失效日期 <i class="red">*</i></th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    <tr ng-repeat="row in levelDetail.positionLevelData" ng-class="{'active':levelDetail.selectRow==$index}"
                        ng-click="levelDetail.selectRow=$index;clickRow(row)">
                        <td class="w30p tl" ng-bind="row.positionName">1</td>
                        <td class="w30p">
                            <div class="input-group input-group-xs">
                                <input type="text" class="form-control radius3" ng-model="row.personName" disabled>
                                <span class="input-group-btn input-xs" style="padding: 0;">
                                    <button type="button" class="btn btn-default" data-toggle="modal" data-target="#person">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </span>
                            </div>
                        </td>
                        <td>
                            <input type="checkbox" ng-true-value="'Y'" ng-false-value="'N'" ng-change="changeEnableFlag(row.enableFlag, row)" ng-model="row.enableFlag">
                        </td>
                        <td class="w15p">
                            <input class="form-control input-xs" ng-model="row.dateFrom" date-time-picker
                                   name="endDate" required data-enddate="{{row.dateTo}}" data-min-view="2"
                                   autocomplete="off" data-date-format="yyyy-mm-dd">
                        </td>
                        <td class="w15p">
                            <input class="form-control input-xs" ng-model="row.dateTo" date-time-picker
                                   name="endDate" required data-stratdate="{{row.dateFrom}}" data-min-view="2"
                                   autocomplete="off" data-date-format="yyyy-mm-dd">
                        </td>
                        <td class="w10p">
                            <button type="button" ng-click="findDownPosition(row)" style="padding: 1px 6px!important;"
                                    class="btn btn-default mr10"><i class="fa fa-level-down"
                                    data-toggle="modal" data-target="#downPosition"></i></button>
                            <a href="javascript:" ng-click="deleteAction(row,$index)"><i
                                    class="fa fa-trash-o fa-lg"></i></a>
                        </td>
                    </tr>
                </table>
            </form>
        </div>
    </div>

    <div lov-list role="dialog" data-title="请选择上级职位" id="upPosition" ng-model="upPositionModel" class=""
         data-url="findBasePositionNewPagination"
         data-auto-request="false"
         data-hide-modal-reset="true"
         data-dynamic-params="{respId:respId}"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-callback="selectUpPosition"
         data-checked-type="radio"
         data-keys="{'key':'positionId','value':'positionName',hide:'true'}" data-other-column="[{'name':'职位编码','key':'positionCode'},{'name':'职位名称',key:'positionName'}]"
         data-show-index="false"
         data-type="competitor"
         data-search-key="[{'key':'positionCode','placeholder':'职位编码'},{'key':'positionName','placeholder':'职位名称'}]"
    >
    </div>

    <div lov-list role="dialog" data-title="请选择职位" id="position" ng-model="positionModel" class=""
         data-url="findBasePositionNewPagination"
         data-auto-request="false"
         data-hide-modal-reset="true"
         data-dynamic-params="{respId:respId}"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-checked-type="checkbox"
         data-callback="selectPosition"
         data-keys="{'key':'positionId','value':'positionName',hide:'true'}" data-other-column="[{'name':'职位编码','key':'positionCode'},{'name':'职位名称',key:'positionName'}]"
         data-show-index="false"
         data-type="competitor"
         data-search-key="[{'key':'positionCode','placeholder':'职位编码'},{'key':'positionName','placeholder':'职位名称'}]"
    >
    </div>

    <div lov-list role="dialog" data-title="请选择上级人员" id="upPerson" ng-model="upPersonModel" class=""
         data-url="findPersonAssignPagination"
         data-auto-request="true"
         data-hide-modal-reset="true"
         data-dynamic-params="{respId:respId,positionId:levelDetail.mgrPositionId}"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-callback="selectHeaderPerson"
         data-checked-type="radio"
         data-keys="{'key':'personId','value':'personName',hide:'true'}" data-other-column="[{'name':'职位名称','key':'positionName'},{'name':'人员姓名',key:'personName'}]"
         data-show-index="false"
         data-type="competitor"
    >
    </div>

    <div lov-list role="dialog" data-title="请选择人员" id="person" ng-model="personModel" class=""
         data-url="findPersonAssignPagination"
         data-auto-request="true"
         data-hide-modal-reset="true"
         data-dynamic-params="{respId:respId,positionId:rowPositionId}"
         data-pagination="{'pageIndex':'1','pageRows':'5'}"
         data-callback="selectPerson"
         data-checked-type="radio"
         data-keys="{'key':'personId','value':'personName',hide:'true'}" data-other-column="[{'name':'职位名称','key':'positionName'},{'name':'人员姓名',key:'personName'}]"
         data-show-index="false"
         data-type="competitor"
    >
    </div>
</div>
